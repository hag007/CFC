
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>חיבור בין טבלאות &#8212; Computers For physics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=ec42b4e3" />
    <link rel="stylesheet" type="text/css" href="../../_static/rtl.css?v=dc79e408" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'vendor/virtual-pyprog/19_6_combine_dfs';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/tau.png" class="logo__image only-light" alt="Computers For physics - Home"/>
    <script>document.write(`<img src="../../_static/tau.png" class="logo__image only-dark" alt="Computers For physics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    ברוכים הבאים לקורס מחשבים לפיסיקאים
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">מידע כללי</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../0_intro.html">מנהלות</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">שבועות הלמידה</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../course/weeks/week_1.html">1. שבוע 1 — טיפוסים ותנאים</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="0_0_objectives.html">1.2. מבוא</a></li>
<li class="toctree-l2"><a class="reference internal" href="0_1_hardware-to-software.html">1.3. חומרה, תוכנה והשיטה הבינארית</a></li>
<li class="toctree-l2"><a class="reference internal" href="0_2_python.html">1.4. שפת התכנות פייתון</a></li>
<li class="toctree-l2"><a class="reference internal" href="0_3_variables-and-assignments.html">1.5. משתנים והשמות</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_intro_types.html">1.6. מבוא לטיפוסים</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_numerical_types.html">1.7. טיפוסים נומריים</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_booleans.html">1.8. משתנים בוליאניים</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_3_strings.html">1.9. מחרוזות</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_4_conversion.html">1.10. המרות בין טיפוסים</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../course/weeks/week_2.html">2. שבוע 2 — תנאים ופונקציות</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="2_0_intro-conditions.html">2.2. מבוא לתנאים</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_1_if-else-statements.html">2.3. משפטי תנאי בסיסיים: <code class="docutils literal notranslate"><span class="pre">if</span></code> ו<code class="docutils literal notranslate"><span class="pre">if-else</span></code></a></li>


<li class="toctree-l2"><a class="reference internal" href="2_2_nested-ifs.html">2.6. תנאים מקוננים</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_3_elif.html">2.7. elif ותנאים מרובים</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_4_logical-operators-in-ifs.html">2.8. אופרטורים לוגיים בתנאים</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_0_intro-functions.html">2.9. מבוא לפונקציות</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_1_builtin-functions.html">2.10. פונקציות מובנות בפייתון</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_2_building-functions.html">2.11. בניית פונקציות משלכם</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_3_formal-and-actual-variables.html">2.12. פרמטרים וארגומנטים</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_5_caller-callee.html">2.13. קריאה הדדית בין פונקציות</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_4_advanced-examples.html">2.14. דוגמאות מתקדמות</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../course/weeks/week_3.html">3. שבוע 3 — רשימות ולולאות</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="4_0_intro-list.html">3.2. מבוא לרשימות</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_1_list-operators-indices.html">3.3. רשימות: אופרטורים בסיסיים ואינדקסים</a></li>

<li class="toctree-l2"><a class="reference internal" href="4_2_built-in-functions-in-list.html">3.5. פונקציות מובנות לרשימות</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_3_list-methods.html">3.6. מתודות של רשימות</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_4_nested_lists.html">3.7. רשימות מקוננות</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_5_list-examples.html">3.8. דוגמאות מעשיות</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../course/weeks/week_4.html">4. שבוע 4 — לולאות וזרימת בקרה</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="5_0_intro-loops.html">4.2. מבוא ללולאות</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_0_for_loops.html">4.3. לולאות for</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_1_ranges-and-for.html">4.4. range ולולאות for</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_2_for-examples.html">4.5. דוגמאות ל־for</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_3_for-summary.html">4.6. סיכום לולאות for</a></li>
<li class="toctree-l2"><a class="reference internal" href="7_0_while_loops.html">4.7. לולאות while</a></li>
<li class="toctree-l2"><a class="reference internal" href="7_1_while-examples.html">4.8. דוגמאות ל־while</a></li>
<li class="toctree-l2"><a class="reference internal" href="8_0_while_vs_for.html">4.9. while לעומת for</a></li>
<li class="toctree-l2"><a class="reference internal" href="8_1_break_and_continue.html">4.10. break ו־continue</a></li>
<li class="toctree-l2"><a class="reference internal" href="8_2_nested_loops.html">4.11. לולאות מקוננות</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../course/weeks/week_5.html">5. שבוע 5 — זיכרון, פונקציות מתקדמות ומבנים בלתי־משתנים</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="10_0_mutable-vs-immutable.html">5.2. Mutable vs Immutable</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_1_memory-in-functions.html">5.3. זיכרון והתנהגות בפונקציות</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_0_advanced_function_usage.html">5.4. שימושים מתקדמים בפונקציות</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../course/weeks/week_6.html">6. שבוע 6 — מבני נתונים וקריאה וכתיבה של מידע</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="12_0_data_structures.html">6.2. מבני נתונים</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_1_tuples.html">6.3. Tuples</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_2_dicts.html">6.4. Dictionaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_0_string-formats.html">6.5. עיצוב מחרוזות</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../course/weeks/week_7.html">7. שבוע 7 — OOP</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="17_0_oop-intro.html">7.2. מבוא ל־OOP</a></li>
<li class="toctree-l2"><a class="reference internal" href="17_1_oop-implementation.html">7.3. מימוש עקרונות OOP</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../course/weeks/week_8.html">8. שבוע 8 — Numpy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_8/8_0_intro_libs.html">8.2. Intro: Setup &amp; libs</a></li>
<li class="toctree-l2"><a class="reference internal" href="18_0_numpy-intro.html">8.3. Intro: NumPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="18_1_create-array.html">8.4. Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_8/8_1_arrays.html">8.5. Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_8/8_2_arrays_indexing.html">8.6. Arrays — Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_8/8_3_datatypes.html">8.7. Datatypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_8/8_4_array_math.html">8.8. Array Math</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_8/8_5_broadcasting.html">8.9. Broadcasting</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../course/weeks/week_9.html">9. שבוע 9 — Matplotlib, Probabilities &amp; Histograms</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_9/9_1_matplotlib.html">9.2. Matplotlib</a></li>


<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_9/9_2_example_matplotlib.html">9.5. דוגמה מסכמת — Matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_9/9_3_prob_hists.html">9.6. Probabilities &amp; Histograms</a></li>


</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../course/weeks/week_10.html">10. שבוע 10 — Numpy מתקדם</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_10/10_1_matrix_operations.html">10.2. פעולות מטריציוניות מתקדמות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_10/10_2_linear_system.html">10.3. פתרון מערכות ליניאריות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_10/10_3_eigen_values.html">10.4. ערכים ווקטורים עצמיים</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_10/10_4_SVD.html">10.5. SVD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_10/10_7_exercises.html">10.6. תרגול עצמי</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_10/10_5_example_image_SVD.html">10.7. תרגול: דחיסת תמונה באמצעות SVD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_10/10_6_example_PI_MC.html">10.8. תרגול: הערכת π בשיטת מונטה־קרלו</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../course/weeks/week_11.html">11. שבוע 11 — SciPy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_11/11_1_physical_consts.html">11.2. קבועים פיזיקליים ויחידות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_11/11_2_integration.html">11.3. אינטגרציה נומרית</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_11/11_3_optimization.html">11.4. אופטימיזציה</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course/weeks/week_11/11_5_example_MB.html">11.5. תרגול: התפלגות מהירות מקסוול–בולצמן (MB)</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../course/weeks/week_12.html">12. שבוע 12 — Pandas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="19_1_pandas-intro.html">12.2. מבוא לעבודה עם Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="19_2_create-df.html">12.3. יצירת טבלה</a></li>
<li class="toctree-l2"><a class="reference internal" href="19_3_access-df.html">12.4. גישה לנתונים בטבלה</a></li>
<li class="toctree-l2"><a class="reference internal" href="19_4_basic_editing.html">12.5. עריכת טבלה</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/TauInnov/CFS/master?urlpath=lab/tree/vendor/virtual-pyprog/19_6_combine_dfs.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/TauInnov/CFS/blob/master/vendor/virtual-pyprog/19_6_combine_dfs.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/TauInnov/CFS" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/TauInnov/CFS/issues/new?title=Issue%20on%20page%20%2Fvendor/virtual-pyprog/19_6_combine_dfs.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/vendor/virtual-pyprog/19_6_combine_dfs.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>חיבור בין טבלאות</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concat">חיבור באמצעות <code class="docutils literal notranslate"><span class="pre">concat</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">חיבור טבלאות לפי שורות (אנכי)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">עבודה עם ערכים חסרים</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">חיבור טבלאות לפי עמודות (אופקי)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#merge">הפונקציה <code class="docutils literal notranslate"><span class="pre">merge</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">טיפול בערכים חסרים</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">תרגול</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><strong>שימו לב</strong>: על מנת להריץ את התאים ב-Live Code, יש לייבא תחילה את ספרית <code class="docutils literal notranslate"><span class="pre">pandas</span></code> ע”י הרצת השורת הראשונה בתא למטה.<br />
בנוסף, נגביל את מספר השורות והעמודות שתופענה בהדפסת הטבלאות ע”י שורות הקוד השניה והשלישית:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span><span class="o">=</span><span class="mi">5</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span><span class="o">=</span><span class="mi">5</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">utils.load_auxilary_files</span> <span class="c1"># This will load the files used for this notebook</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;dog_noised.png&#39;, &#39;sunday.txt&#39;, &#39;orders_3_2024.csv&#39;, &#39;dialation_2.png&#39;, &#39;woman_noised.png&#39;, &#39;erosion_2.png&#39;, &#39;infile1.txt&#39;, &#39;notebook_resources.zip&#39;, &#39;countries-of-the-world.csv&#39;, &#39;ex1.csv&#39;, &#39;StudentsGrades.csv&#39;, &#39;out.txt&#39;, &#39;dog.png&#39;, &#39;foods.txt&#39;, &#39;dialation.png&#39;, &#39;__MACOSX&#39;, &#39;evil_morty_segmentation.png&#39;, &#39;products2.csv&#39;, &#39;orders_2_2024.csv&#39;, &#39;evil_morty_1.png&#39;, &#39;monday.txt&#39;, &#39;ship.png&#39;, &#39;koala.png&#39;, &#39;baby.png&#39;, &#39;erosion.png&#39;, &#39;evil_morty_change_noised.png&#39;, &#39;orders_4_2024.csv&#39;, &#39;ex2.csv&#39;, &#39;evil_morty_change.png&#39;, &#39;evil_morty_change_3.png&#39;, &#39;infile2.txt&#39;, &#39;witcher_1.csv&#39;, &#39;witcher_2.csv&#39;]
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>חיבור בין טבלאות<a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
<p>בחלק זה נעמיק ביכולת לשלב ולאחד בין טבלאות שונות.</p>
<p>ב־pandas קיימות שתי פונקציות עיקריות לביצוע פעולות אלה - <code class="docutils literal notranslate"><span class="pre">concat</span></code> ו־<code class="docutils literal notranslate"><span class="pre">merge</span></code>.
הפונקציה <code class="docutils literal notranslate"><span class="pre">concat</span></code> משמשת לחיבור טבלאות זו אל זו, בצורה אנכית (הוספת שורות) או אופקית (הוספת עמודות). למעשה, כבר פגשנו אותה כשעסקנו בהוספת שורות ועמודות לטבלה קיימת.<br />
בהמשך נראה כיצד להשתמש בה באופן רחב יותר, וגם נלמד על <code class="docutils literal notranslate"><span class="pre">merge</span></code>, המאפשרת איחוד חכם ומבוסס־מפתחות בין טבלאות שונות.</p>
<p>הפעולות להלן יודגמו טבלת הציונים <code class="docutils literal notranslate"><span class="pre">&quot;files/StudentsGrades.csv&quot;</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inputFileName</span> <span class="o">=</span> <span class="s2">&quot;files/StudentsGrades.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">inputFileName</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Programming</th>
      <th>...</th>
      <th>Planet Survival</th>
      <th>Art</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Yael</td>
      <td>50</td>
      <td>...</td>
      <td>65</td>
      <td>91</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Nadav</td>
      <td>61</td>
      <td>...</td>
      <td>52</td>
      <td>88</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Tom</td>
      <td>98</td>
      <td>...</td>
      <td>92</td>
      <td>80</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Adi</td>
      <td>76</td>
      <td>...</td>
      <td>84</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
<p>13 rows × 8 columns</p>
</div></div></div>
</div>
<section id="concat">
<h2>חיבור באמצעות <code class="docutils literal notranslate"><span class="pre">concat</span></code><a class="headerlink" href="#concat" title="Link to this heading">#</a></h2>
<section id="id2">
<h3>חיבור טבלאות לפי שורות (אנכי)<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>ביחידות הקודמות ראינו כיצד ניתן להשתמש ב<code class="docutils literal notranslate"><span class="pre">concat</span></code> על מנת לחבר שורה או עמודה בודדת.</p>
<div class="info admonition">
<p class="admonition-title"><strong>תזכורת:</strong> הפונקציה concat</p>
<p><code class="docutils literal notranslate"><span class="pre">concat</span></code> מחברת בין טבלאות לפי:</p>
<ul class="simple">
<li><p>שמות העמודות - במקרה של הוספת שורות/<code class="docutils literal notranslate"><span class="pre">axis=0</span></code></p></li>
<li><p>שמות שורות - במקרה של הוספת עמודות/<code class="docutils literal notranslate"><span class="pre">axis=1</span></code>.</p></li>
</ul>
<p>לדוגמא, מקודם ראינו כי כך מוסיפים שורה חדשה לטבלה:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">new_student</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span><span class="s2">&quot;Dana&quot;</span><span class="p">,</span><span class="s1">&#39;Programming&#39;</span><span class="p">:</span><span class="mf">76.0</span><span class="p">,</span><span class="s1">&#39;Marine Biology&#39;</span><span class="p">:</span><span class="mf">65.0</span><span class="p">,</span><span class="s1">&#39;Stellar Cartography&#39;</span><span class="p">:</span><span class="mf">98.0</span><span class="p">,</span><span class="s1">&#39;Math&#39;</span><span class="p">:</span><span class="mf">8.07</span><span class="p">,</span>
                <span class="s1">&#39;History&#39;</span><span class="p">:</span><span class="mf">65.0</span><span class="p">,</span><span class="s1">&#39;Planet Survival&#39;</span><span class="p">:</span><span class="mf">89.0</span><span class="p">,</span><span class="s1">&#39;Art&#39;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">}]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">new_student</span><span class="p">)</span>
<span class="n">df_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">new_student</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<p>באופן אינטואיטיבי, כפי שחיברנו לטבלה בעלת שורה בודדת לטבלה אחרת, <strong>ניתן לחבר גם טבלה בעלת מספר שורות</strong>.<br />
יתרה מכך, ניתן אף לחבר <strong>מספר טבלאות</strong>. כל מה שצריך זה להעביר בארגומנט הראשון טאפל או רשימה המכילים מספר טבלאות בעלות אותן עמודות (אחרת נקבל תאים ריקים, או <code class="docutils literal notranslate"><span class="pre">NaN</span></code>ים).</p>
<div class="error admonition">
<p class="admonition-title"><strong>שימו לב</strong></p>
<p>גם פה יש להקפיד להעביר ל<code class="docutils literal notranslate"><span class="pre">concat</span></code> את הפרמטר <code class="docutils literal notranslate"><span class="pre">ignore_index=True</span></code>, אחרת נקבל שמות שורות כפולים</p>
</div>
<p>להלן דוגמא לחיבור אנכי (כלומר, לפי שורות) בין שתי טבלאות:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inputFileName</span> <span class="o">=</span> <span class="s2">&quot;files/StudentsGrades.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">inputFileName</span><span class="p">)</span>
<span class="c1"># df=df.head(3) # For simplicity, we take only the first three rows of the table</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Programming</th>
      <th>...</th>
      <th>Planet Survival</th>
      <th>Art</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Yael</td>
      <td>50</td>
      <td>...</td>
      <td>65</td>
      <td>91</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Nadav</td>
      <td>61</td>
      <td>...</td>
      <td>52</td>
      <td>88</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Tom</td>
      <td>98</td>
      <td>...</td>
      <td>92</td>
      <td>80</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Adi</td>
      <td>76</td>
      <td>...</td>
      <td>84</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
<p>13 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lst_staff</span> <span class="o">=</span> \
        <span class="p">[{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span><span class="s2">&quot;Shahar&quot;</span><span class="p">,</span><span class="s1">&#39;Programming&#39;</span><span class="p">:</span><span class="mf">45.0</span><span class="p">,</span><span class="s1">&#39;Marine Biology&#39;</span><span class="p">:</span><span class="mf">15.0</span><span class="p">,</span><span class="s1">&#39;Stellar Cartography&#39;</span><span class="p">:</span><span class="mf">87.0</span><span class="p">,</span><span class="s1">&#39;Math&#39;</span><span class="p">:</span><span class="mf">81.0</span><span class="p">,</span>
          <span class="s1">&#39;History&#39;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">,</span><span class="s1">&#39;Planet Survival&#39;</span><span class="p">:</span><span class="mf">82.0</span><span class="p">,</span><span class="s1">&#39;Art&#39;</span><span class="p">:</span><span class="mf">24.0</span><span class="p">},</span>
         <span class="p">{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span><span class="s2">&quot;Hagai&quot;</span><span class="p">,</span><span class="s1">&#39;Programming&#39;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">,</span><span class="s1">&#39;Marine Biology&#39;</span><span class="p">:</span><span class="mf">62.0</span><span class="p">,</span><span class="s1">&#39;Stellar Cartography&#39;</span><span class="p">:</span><span class="mf">78.0</span><span class="p">,</span><span class="s1">&#39;Math&#39;</span><span class="p">:</span><span class="mf">10.0</span><span class="p">,</span>
          <span class="s1">&#39;History&#39;</span><span class="p">:</span><span class="mf">62.0</span><span class="p">,</span><span class="s1">&#39;Planet Survival&#39;</span><span class="p">:</span><span class="mf">69.0</span><span class="p">,</span><span class="s1">&#39;Art&#39;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">},</span>
         <span class="p">{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span><span class="s2">&quot;Inbal&quot;</span><span class="p">,</span><span class="s1">&#39;Programming&#39;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">,</span><span class="s1">&#39;Marine Biology&#39;</span><span class="p">:</span><span class="mf">25.0</span><span class="p">,</span><span class="s1">&#39;Stellar Cartography&#39;</span><span class="p">:</span><span class="mf">84.0</span><span class="p">,</span><span class="s1">&#39;Math&#39;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">,</span>
          <span class="s1">&#39;History&#39;</span><span class="p">:</span><span class="mf">95.0</span><span class="p">,</span><span class="s1">&#39;Planet Survival&#39;</span><span class="p">:</span><span class="mf">99.0</span><span class="p">,</span><span class="s1">&#39;Art&#39;</span><span class="p">:</span><span class="mf">30.0</span><span class="p">}]</span>
<span class="n">df_staff</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lst_staff</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_staff</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Programming</th>
      <th>...</th>
      <th>Planet Survival</th>
      <th>Art</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Shahar</td>
      <td>45.0</td>
      <td>...</td>
      <td>82.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Hagai</td>
      <td>100.0</td>
      <td>...</td>
      <td>69.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Inbal</td>
      <td>100.0</td>
      <td>...</td>
      <td>99.0</td>
      <td>30.0</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df_staff</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># ignores the original indices to avoid duplicated indices</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Programming</th>
      <th>...</th>
      <th>Planet Survival</th>
      <th>Art</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Yael</td>
      <td>50.0</td>
      <td>...</td>
      <td>65.0</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Nadav</td>
      <td>61.0</td>
      <td>...</td>
      <td>52.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Hagai</td>
      <td>100.0</td>
      <td>...</td>
      <td>69.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Inbal</td>
      <td>100.0</td>
      <td>...</td>
      <td>99.0</td>
      <td>30.0</td>
    </tr>
  </tbody>
</table>
<p>16 rows × 8 columns</p>
</div></div></div>
</div>
</section>
<section id="id3">
<h3>עבודה עם ערכים חסרים<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>בעת עבודה עם נתונים בטבלה, ניתקל לעיתים בערכים חסרים (<code class="docutils literal notranslate"><span class="pre">NaN</span></code> – Not a Number), שמציינים מידע שלא קיים או שלא נמדד. ערכים אלו עלולים להשפיע על חישובים, גרפים וניתוחים סטטיסטיים, ולכן חשוב לזהות ולטפל בהם באופן מושכל לפני המשך העיבוד.</p>
<p>בקוד שלהלן ניסו לחבר בין טבלת הציונים שלנו לבין טבלת ציונים נוספת של סטודנטים מהטכניון, והתקבלו תאים ריקים (<code class="docutils literal notranslate"><span class="pre">NaN</span></code>ים).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lst_grades_from_technion</span> <span class="o">=</span> \
        <span class="p">[{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span><span class="s2">&quot;Shahar&quot;</span><span class="p">,</span> <span class="s1">&#39;Machine Learning&#39;</span><span class="p">:</span><span class="mf">96.0</span><span class="p">,</span><span class="s1">&#39;Spanish&#39;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">,</span><span class="s1">&#39;Karting&#39;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">,</span> <span class="s1">&#39;Yoga&#39;</span><span class="p">:</span> <span class="mf">97.0</span><span class="p">},</span>
         <span class="p">{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span><span class="s2">&quot;Hagai&quot;</span><span class="p">,</span> <span class="s1">&#39;Machine Learning&#39;</span><span class="p">:</span><span class="mf">98.0</span><span class="p">,</span><span class="s1">&#39;Spanish&#39;</span><span class="p">:</span><span class="mf">65.0</span><span class="p">,</span><span class="s1">&#39;Karting&#39;</span><span class="p">:</span><span class="mf">87.0</span><span class="p">,</span> <span class="s1">&#39;Yoga&#39;</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">},</span>
         <span class="p">{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span><span class="s2">&quot;Inbal&quot;</span><span class="p">,</span> <span class="s1">&#39;Machine Learning&#39;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">,</span><span class="s1">&#39;Spanish&#39;</span><span class="p">:</span><span class="mf">92.0</span><span class="p">,</span><span class="s1">&#39;Karting&#39;</span><span class="p">:</span><span class="mf">95.0</span><span class="p">,</span> <span class="s1">&#39;Yoga&#39;</span><span class="p">:</span> <span class="mf">86.0</span><span class="p">},</span>
         <span class="p">{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span><span class="s2">&quot;Rotem&quot;</span><span class="p">,</span> <span class="s1">&#39;Machine Learning&#39;</span><span class="p">:</span><span class="mf">80.0</span><span class="p">,</span><span class="s1">&#39;Spanish&#39;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">,</span><span class="s1">&#39;Karting&#39;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">,</span> <span class="s1">&#39;Yoga&#39;</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">},</span>
        <span class="p">]</span>
<span class="n">df_from_technion</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lst_grades_from_technion</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_from_technion</span><span class="p">)</span>

<span class="n">df_after_concat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df_from_technion</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_after_concat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Programming</th>
      <th>...</th>
      <th>Planet Survival</th>
      <th>Art</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Yael</td>
      <td>50</td>
      <td>...</td>
      <td>65</td>
      <td>91</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Nadav</td>
      <td>61</td>
      <td>...</td>
      <td>52</td>
      <td>88</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Tom</td>
      <td>98</td>
      <td>...</td>
      <td>92</td>
      <td>80</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Adi</td>
      <td>76</td>
      <td>...</td>
      <td>84</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
<p>13 rows × 8 columns</p>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Machine Learning</th>
      <th>Spanish</th>
      <th>Karting</th>
      <th>Yoga</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Shahar</td>
      <td>96.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>97.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Hagai</td>
      <td>98.0</td>
      <td>65.0</td>
      <td>87.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Inbal</td>
      <td>100.0</td>
      <td>92.0</td>
      <td>95.0</td>
      <td>86.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Rotem</td>
      <td>80.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>100.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Programming</th>
      <th>...</th>
      <th>Karting</th>
      <th>Yoga</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Yael</td>
      <td>50.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Nadav</td>
      <td>61.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Inbal</td>
      <td>NaN</td>
      <td>...</td>
      <td>95.0</td>
      <td>86.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Rotem</td>
      <td>NaN</td>
      <td>...</td>
      <td>100.0</td>
      <td>100.0</td>
    </tr>
  </tbody>
</table>
<p>17 rows × 12 columns</p>
</div></div></div>
</div>
<div class="dropdown caution admonition">
<p class="admonition-title"><strong>עצרו וחישבו:</strong>  מדעו קיבלנו ערכים ריקים במהלך חיבור הטבלאות?</p>
<p>שימו לב ששמות העמודות בטבלת הסטודנטים מהטכניון שונים משמות העמודות בטבלת תל אביב. בעת ביצוע חיבור אנכי (<code class="docutils literal notranslate"><span class="pre">concat</span></code>), pandas מבצעת <strong>יישור לפי שמות העמודות</strong>.
כלומר, עמודות עם אותו שם מתאחדות, אך עמודות ששמן שונה אינן נחשבות תואמות.
לכן, לסטודנטים מתל אביב אין ערכים בעמודת “ספרדית”, ואילו לסטודנטים מהטכניון אין ערכים בעמודת “היסטוריה”.
במקומות שבהם חסר מידע, pandas ממלאת ערך ריק (<code class="docutils literal notranslate"><span class="pre">NaN</span></code>).</p>
<p>באופן דומה, אם נבצע <strong>חיבור אופקי</strong> כאשר שמות השורות אינם חופפים, נקבל <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
</div>
<p>בשלב זה ניתן לשאול באופן טבעי כיצד יש לטפל בנתונים חסרים. בהמשך נראה דרכים לעשות זאת.</p>
</section>
<section id="id4">
<h3>חיבור טבלאות לפי עמודות (אופקי)<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>באופן אנלוגי, <strong>ניתן לחבר גם מספר טבלאות באופן אופקי</strong> כלומר, במקום לשרשר שורות, <strong>לשרשר עמודות</strong>. נעשה זאת ע”י העברת הפרמטר <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> בעת הקריאה ל<code class="docutils literal notranslate"><span class="pre">concat</span></code>.<br />
פה יש להקפיד כי לטבלאות יהיו שמות שורות זהים (אחרת נקבל תאים ריקים, או <code class="docutils literal notranslate"><span class="pre">NaN</span></code>ים).</p>
<p>בקוד שלהלן ניסו לחבר לטבלת הציונים שלנו טבלת ציונים נוספת של סטונדטים <strong>שעברו מהטכניון לתל אביב</strong>, כלומר, יש להם ציונים בקורסים הנלמדים ב2 המוסדות. הניחו כי השמות הפרטיים יחודיים (כלומר, לא קיימים 2 סטונדטים בעלי אותו שם).<br />
קבעו מדוע מופיעים תאים ריקים (<code class="docutils literal notranslate"><span class="pre">NaN</span></code>ים) בטבלה המאוחדת (האחרונה שמודפסת).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lst_grades_from_technion</span> <span class="o">=</span> \
        <span class="p">[{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span><span class="s2">&quot;Tom&quot;</span><span class="p">,</span> <span class="s1">&#39;Machine Learning&#39;</span><span class="p">:</span><span class="mf">96.0</span><span class="p">,</span><span class="s1">&#39;Spanish&#39;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">,</span><span class="s1">&#39;Karting&#39;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">,</span> <span class="s1">&#39;Yoga&#39;</span><span class="p">:</span> <span class="mf">97.0</span><span class="p">},</span>
         <span class="p">{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span><span class="s2">&quot;Adi&quot;</span><span class="p">,</span> <span class="s1">&#39;Machine Learning&#39;</span><span class="p">:</span><span class="mf">98.0</span><span class="p">,</span><span class="s1">&#39;Spanish&#39;</span><span class="p">:</span><span class="mf">65.0</span><span class="p">,</span><span class="s1">&#39;Karting&#39;</span><span class="p">:</span><span class="mf">87.0</span><span class="p">,</span> <span class="s1">&#39;Yoga&#39;</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">}</span>
        <span class="p">]</span>
<span class="n">df_from_technion</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lst_grades_from_technion</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_from_technion</span><span class="p">)</span>

<span class="n">df_after_concat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df_from_technion</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_after_concat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Programming</th>
      <th>...</th>
      <th>Planet Survival</th>
      <th>Art</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Yael</td>
      <td>50</td>
      <td>...</td>
      <td>65</td>
      <td>91</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Nadav</td>
      <td>61</td>
      <td>...</td>
      <td>52</td>
      <td>88</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Tom</td>
      <td>98</td>
      <td>...</td>
      <td>92</td>
      <td>80</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Adi</td>
      <td>76</td>
      <td>...</td>
      <td>84</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
<p>13 rows × 8 columns</p>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Machine Learning</th>
      <th>Spanish</th>
      <th>Karting</th>
      <th>Yoga</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Tom</td>
      <td>96.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>97.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adi</td>
      <td>98.0</td>
      <td>65.0</td>
      <td>87.0</td>
      <td>100.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Programming</th>
      <th>...</th>
      <th>Karting</th>
      <th>Yoga</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Yael</td>
      <td>50</td>
      <td>...</td>
      <td>100.0</td>
      <td>97.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Nadav</td>
      <td>61</td>
      <td>...</td>
      <td>87.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Tom</td>
      <td>98</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Adi</td>
      <td>76</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>13 rows × 13 columns</p>
</div></div></div>
</div>
<p>מה הבעיה בטבלה לעיל?</p>
<p>בטבלה המאוחדת (האחרונה שמודפסת) הסטודנטים שעברו מהטכניון <strong>הוצלבו עם השורות הלא נכונות</strong>. ההצלבה נעשתה לפי שם השורה (0,1,2) ולא לפי שמות הסטודנטים (Tom, Adi).</p>
<p>ניתן לתקן זאת בשתי דרכים:</p>
<p>נוכל להגדיר את שמות הסטודנטים כשמות השורות, ואז לבצע <code class="docutils literal notranslate"><span class="pre">concat</span></code> כרגיל.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span>
<span class="n">df_from_technion</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="n">df_from_technion</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df_from_technion</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Programming</th>
      <th>...</th>
      <th>Karting</th>
      <th>Yoga</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Yael</th>
      <td>Yael</td>
      <td>50</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Nadav</th>
      <td>Nadav</td>
      <td>61</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Tom</th>
      <td>Tom</td>
      <td>98</td>
      <td>...</td>
      <td>100.0</td>
      <td>97.0</td>
    </tr>
    <tr>
      <th>Adi</th>
      <td>Adi</td>
      <td>76</td>
      <td>...</td>
      <td>87.0</td>
      <td>100.0</td>
    </tr>
  </tbody>
</table>
<p>13 rows × 13 columns</p>
</div></div></div>
</div>
<p>פתרון זה לכאורה עובד, אך הוא בעיתי משתי סיבות:</p>
<ul class="simple">
<li><p>עלינו לשנות את שמות השורות למפתח לפיו נרצה לעשות את האיחוד. לא תמיד יש לנו הבטחה שאין כפילויות בעמודת המפתח!</p></li>
<li><p>העמודה <code class="docutils literal notranslate"><span class="pre">Name</span></code> כעת מופיעה גם כעמודה וגם בשמות השורות. נצטרך לבצע פעולה נוספת.</p></li>
</ul>
<p>פתרון נוסף הוא שימוש בפונקציה חדשה בשם <code class="docutils literal notranslate"><span class="pre">merge</span></code> כפי שנראה כעת.</p>
</section>
</section>
<section id="merge">
<h2>הפונקציה <code class="docutils literal notranslate"><span class="pre">merge</span></code><a class="headerlink" href="#merge" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">merge</span></code> מחברת <strong>זוג טבלאות</strong> ו<strong>בחיבור אופקי בלבד</strong> (כלומר, חיבור עמודות). הייחודיות של <code class="docutils literal notranslate"><span class="pre">merge</span></code> היא האפשרות לבצע חיבור טבלאות <strong>על בסיס עמודה, או מספר עמודות</strong> בעלות ערכים תואמים. כלומר, <code class="docutils literal notranslate"><span class="pre">merge</span></code> עובדת על-ידי הגדרת מפתח משותף על פיו מחברים את הטבלאות.</p>
<p>ההבדל העיקרי הוא אם החיבור מתבצע בצורה ישירה (כמו חיבור רשימות) באמצעות <code class="docutils literal notranslate"><span class="pre">concat</span></code>, או בהתאמה חכמה בין שורות באמצעות <code class="docutils literal notranslate"><span class="pre">merge</span></code>. הבחירה בין השתיים תלויה בשאלה האם מדובר בטבלאות “באותו מבנה” או בטבלאות שונות שצריך לקשר ביניהן דרך ערכים משותפים.</p>
<p>לפונקציה <code class="docutils literal notranslate"><span class="pre">merge</span></code> קיימים 2 פרמטרים חשובים:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">on</span></code>: מגדיר את העמודה או העמודות שעל פיהן יתבצע החיבור. עמודה או עמודות אלו נקראות גם לעיתים <strong>מפתח</strong>.<br />
אם מכניסים ל<code class="docutils literal notranslate"><span class="pre">on</span></code> מפתח שהוא מחרוזת, לדוגמה <code class="docutils literal notranslate"><span class="pre">'x'</span></code>, החיבור ייעשה לפי ערכים תואמים בעמודה <code class="docutils literal notranslate"><span class="pre">x</span></code> בלבד. אם מציינים רשימה כמו <code class="docutils literal notranslate"><span class="pre">on=['x','y']</span></code>, החיבור ייעשה רק במקומות שבהם יש התאמה <strong>גם</strong> בעמודה <code class="docutils literal notranslate"><span class="pre">x</span></code> <strong>וגם</strong> בעמודה <code class="docutils literal notranslate"><span class="pre">y</span></code>. כך ניתן לשלוט בדיוק באילו תנאים הטבלאות יתחברו.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">how</span></code>: מגדיר את <strong>אופן החיבור</strong> בין הטבלאות. ערך זה מקבל את אחת מארבע המחרוזות הבאות: <code class="docutils literal notranslate"><span class="pre">'inner',</span> <span class="pre">'outer',</span> <span class="pre">'left',</span> <span class="pre">'right'</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">inner</span></code>: התוצאה תכלול רק את השורות שיש להן ערכים תואמים בעמודות שעליהן מתבצע החיבור – כלומר חיתוך (intersection).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outer</span></code>: התוצאה תכלול את כל השורות משתי הטבלאות, גם אם אין להן התאמה, כך שמתקבל איחוד (union) מלא עם ערכי <code class="docutils literal notranslate"><span class="pre">NaN</span></code> במקום שאין התאמה.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">left</span></code>: התוצאה תשמור את כל השורות מהטבלה השמאלית (הראשונה שהועברה ל־<code class="docutils literal notranslate"><span class="pre">merge</span></code>) ומוסיפה להן נתונים מהטבלה הימנית רק במקומות שבהם יש התאמה.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">right</span></code>: המצב הפוך – כל השורות מהטבלה הימנית נשמרות, ואליהן מצורפים נתונים מהטבלה השמאלית רק כאשר יש התאמה.</p></li>
</ul>
</li>
</ul>
<p>נחזור לדוגמא שלנו, תחילה נטען מחדש את הטבלאות (כדי לאפס את כל השינויים שעשינו להן עד עכשיו):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inputFileName</span> <span class="o">=</span> <span class="s2">&quot;files/StudentsGrades.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">inputFileName</span><span class="p">)</span>

<span class="n">lst_grades_from_technion</span> <span class="o">=</span> \
        <span class="p">[{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span><span class="s2">&quot;Tom&quot;</span><span class="p">,</span> <span class="s1">&#39;Machine Learning&#39;</span><span class="p">:</span><span class="mf">96.0</span><span class="p">,</span><span class="s1">&#39;Spanish&#39;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">,</span><span class="s1">&#39;Karting&#39;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">,</span> <span class="s1">&#39;Yoga&#39;</span><span class="p">:</span> <span class="mf">97.0</span><span class="p">},</span>
         <span class="p">{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span><span class="s2">&quot;Adi&quot;</span><span class="p">,</span> <span class="s1">&#39;Machine Learning&#39;</span><span class="p">:</span><span class="mf">98.0</span><span class="p">,</span><span class="s1">&#39;Spanish&#39;</span><span class="p">:</span><span class="mf">65.0</span><span class="p">,</span><span class="s1">&#39;Karting&#39;</span><span class="p">:</span><span class="mf">87.0</span><span class="p">,</span> <span class="s1">&#39;Yoga&#39;</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">}</span>
        <span class="p">]</span>
<span class="n">df_from_technion</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lst_grades_from_technion</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>כעת, נבצע <code class="docutils literal notranslate"><span class="pre">merge</span></code> לפי שמות הסטונדטים, כלומר, על העמודה <code class="docutils literal notranslate"><span class="pre">Name</span></code> המשותפת בין הטבלאות.<br />
אם נרצה <strong>רק את הסטודנטים שהיו בשני המוסדות</strong>, נגדיר את <code class="docutils literal notranslate"><span class="pre">how</span></code> להיות <code class="docutils literal notranslate"><span class="pre">'inner'</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df_from_technion</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Programming</th>
      <th>...</th>
      <th>Karting</th>
      <th>Yoga</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Tom</td>
      <td>98</td>
      <td>...</td>
      <td>100.0</td>
      <td>97.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adi</td>
      <td>76</td>
      <td>...</td>
      <td>87.0</td>
      <td>100.0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 12 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">df_after_merge_outer</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">display</span><span class="p">(</span><span class="n">df_after_merge_outer</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;df_after_merge_outer&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>לעומת זאת, אם נרצה את הטבלה המאוחדת עם <strong>כל הסטונדטים</strong>, נגדיר את <code class="docutils literal notranslate"><span class="pre">how</span></code> להיות <code class="docutils literal notranslate"><span class="pre">'outer'</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merged</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df_from_technion</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_merged</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Programming</th>
      <th>Marine Biology</th>
      <th>Stellar Cartography</th>
      <th>Math</th>
      <th>History</th>
      <th>Planet Survival</th>
      <th>Art</th>
      <th>Machine Learning</th>
      <th>Spanish</th>
      <th>Karting</th>
      <th>Yoga</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adi</td>
      <td>76</td>
      <td>87</td>
      <td>34</td>
      <td>90</td>
      <td>88</td>
      <td>84</td>
      <td>70</td>
      <td>98.0</td>
      <td>65.0</td>
      <td>87.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Avi</td>
      <td>78</td>
      <td>64</td>
      <td>54</td>
      <td>88</td>
      <td>97</td>
      <td>76</td>
      <td>100</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Yaniv</td>
      <td>100</td>
      <td>64</td>
      <td>62</td>
      <td>95</td>
      <td>61</td>
      <td>88</td>
      <td>90</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Yarden</td>
      <td>63</td>
      <td>62</td>
      <td>70</td>
      <td>74</td>
      <td>92</td>
      <td>98</td>
      <td>94</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>13 rows × 12 columns</p>
</div></div></div>
</div>
<p>כפי שאנו רואים, ישנם הרבה תאים ריקים (<code class="docutils literal notranslate"><span class="pre">NaN</span></code>ים). האם ניתן לטפל בהם בצורה כלשהי?</p>
</section>
<section id="id5">
<h2>טיפול בערכים חסרים<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<p>ב־pandas יש שתי דרכים עיקריות להתמודד עם ערכים חסרים (<code class="docutils literal notranslate"><span class="pre">NaN</span></code>):</p>
<ol class="arabic simple">
<li><p><strong>להחליף את הערכים החסרים בערכים אחרים</strong> באמצעות המתודה <code class="docutils literal notranslate"><span class="pre">()fillna</span></code>. ניתן, למשל, להציב לציון חסר ערך מיוחד כמו 200, או לבחור ערך מייצג אחר - אפס, ממוצע, חציון, או כל ערך שנראה מתאים לנתונים.</p></li>
<li><p><strong>להסיר שורות או עמודות המכילות ערכים חסרים</strong>, באמצעות <code class="docutils literal notranslate"><span class="pre">()dropna</span></code>, או רק לאתר אילו מקומות חסרים בעזרת <code class="docutils literal notranslate"><span class="pre">()isnull</span></code>.</p></li>
</ol>
<p>הבחירה בין שתי הגישות תלויה באופי הנתונים ובמטרת הניתוח: אם יש מעט ערכים חסרים, ייתכן שעדיף להסירם; אך אם הם מופיעים בתדירות גבוהה או במשתנים חשובים, עדיף למלא אותם בערכים מתוקנים כדי לשמור על שלמות הנתונים.</p>
<p><strong>דרך ראשונה:</strong> להחליף את כל הערכים החסרים ב-200.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merged</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Programming</th>
      <th>Marine Biology</th>
      <th>Stellar Cartography</th>
      <th>Math</th>
      <th>History</th>
      <th>Planet Survival</th>
      <th>Art</th>
      <th>Machine Learning</th>
      <th>Spanish</th>
      <th>Karting</th>
      <th>Yoga</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adi</td>
      <td>76</td>
      <td>87</td>
      <td>34</td>
      <td>90</td>
      <td>88</td>
      <td>84</td>
      <td>70</td>
      <td>98.0</td>
      <td>65.0</td>
      <td>87.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Avi</td>
      <td>78</td>
      <td>64</td>
      <td>54</td>
      <td>88</td>
      <td>97</td>
      <td>76</td>
      <td>100</td>
      <td>200.0</td>
      <td>200.0</td>
      <td>200.0</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Yaniv</td>
      <td>100</td>
      <td>64</td>
      <td>62</td>
      <td>95</td>
      <td>61</td>
      <td>88</td>
      <td>90</td>
      <td>200.0</td>
      <td>200.0</td>
      <td>200.0</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Yarden</td>
      <td>63</td>
      <td>62</td>
      <td>70</td>
      <td>74</td>
      <td>92</td>
      <td>98</td>
      <td>94</td>
      <td>200.0</td>
      <td>200.0</td>
      <td>200.0</td>
      <td>200.0</td>
    </tr>
  </tbody>
</table>
<p>13 rows × 12 columns</p>
</div></div></div>
</div>
<p><strong>דרך שנייה:</strong> נסנן החוצה את כל הסטודנטים שאין להם ציון ב<code class="docutils literal notranslate"><span class="pre">Karting</span></code>, לדוגמא.<br />
לצורך כך, ניתן להשתמש ב-Masking עם המתודה <code class="docutils literal notranslate"><span class="pre">isnull</span></code>, המחזירה מסכה המסמנת ב<code class="docutils literal notranslate"><span class="pre">True</span></code> את התאים הריקים:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merged</span><span class="p">[</span><span class="o">~</span><span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;Karting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Programming</th>
      <th>Marine Biology</th>
      <th>Stellar Cartography</th>
      <th>Math</th>
      <th>History</th>
      <th>Planet Survival</th>
      <th>Art</th>
      <th>Machine Learning</th>
      <th>Spanish</th>
      <th>Karting</th>
      <th>Yoga</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adi</td>
      <td>76</td>
      <td>87</td>
      <td>34</td>
      <td>90</td>
      <td>88</td>
      <td>84</td>
      <td>70</td>
      <td>98.0</td>
      <td>65.0</td>
      <td>87.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Tom</td>
      <td>98</td>
      <td>76</td>
      <td>98</td>
      <td>100</td>
      <td>98</td>
      <td>92</td>
      <td>80</td>
      <td>96.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>97.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="error admonition">
<p class="admonition-title"><strong>שימו לב</strong></p>
<p>כיוון ש<code class="docutils literal notranslate"><span class="pre">isnull</span></code> מחזיר <code class="docutils literal notranslate"><span class="pre">True</span></code> עבור ערכים ריקים, הפעלנו אופרטור שלילה <code class="docutils literal notranslate"><span class="pre">~</span></code> על מנת להפוך בין הערכים הבוליאניים.</p>
</div>
<section id="id6">
<h3>תרגול<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>החליפו את את כל ערכים הריקים ב-<code class="docutils literal notranslate"><span class="pre">Karting</span></code> ל-0, ואת כל הערכים הריקים ב<code class="docutils literal notranslate"><span class="pre">Yoga</span></code> ל-200.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown tip admonition">
<p class="admonition-title"><strong>רמז</strong></p>
<p>השתמשו בשתי פעולות Masking.</p>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "TauInnov/CFS",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./vendor/virtual-pyprog"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concat">חיבור באמצעות <code class="docutils literal notranslate"><span class="pre">concat</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">חיבור טבלאות לפי שורות (אנכי)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">עבודה עם ערכים חסרים</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">חיבור טבלאות לפי עמודות (אופקי)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#merge">הפונקציה <code class="docutils literal notranslate"><span class="pre">merge</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">טיפול בערכים חסרים</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">תרגול</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>