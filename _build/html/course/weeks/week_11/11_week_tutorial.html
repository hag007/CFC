
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>מדידת תאוצת הכובד בעזרת מטוטלת חכמה &#8212; Computers For physics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/rtl.css?v=dc79e408" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'course/weeks/week_11/11_week_tutorial';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/tau.png" class="logo__image only-light" alt="Computers For physics - Home"/>
    <script>document.write(`<img src="../../../_static/tau.png" class="logo__image only-dark" alt="Computers For physics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    ברוכים הבאים לקורס מחשבים לפיסיקאים
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">מידע כללי</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../0_intro.html">מנהלות</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">שבועות הלמידה</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_1.html">1. שבוע 1 — טיפוסים ותנאים</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/0_0_objectives.html">1.2. מבוא</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/0_1_hardware-to-software.html">1.3. חומרה, תוכנה והשיטה הבינארית</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/0_2_python.html">1.4. שפת התכנות פייתון</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/0_3_variables-and-assignments.html">1.5. משתנים והשמות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/1_0_intro_types.html">1.6. מבוא לטיפוסים</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/1_1_numerical_types.html">1.7. טיפוסים נומריים</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/1_2_booleans.html">1.8. משתנים בוליאניים</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/1_3_strings.html">1.9. מחרוזות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/1_4_conversion.html">1.10. המרות בין טיפוסים</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_2.html">2. שבוע 2 — תנאים ופונקציות</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/2_0_intro-conditions.html">2.2. מבוא לתנאים</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/2_1_if-else-statements.html">2.3. משפטי תנאי בסיסיים: <code class="docutils literal notranslate"><span class="pre">if</span></code> ו<code class="docutils literal notranslate"><span class="pre">if-else</span></code></a></li>


<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/2_2_nested-ifs.html">2.6. תנאים מקוננים</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/2_3_elif.html">2.7. elif ותנאים מרובים</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/2_4_logical-operators-in-ifs.html">2.8. אופרטורים לוגיים בתנאים</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/3_0_intro-functions.html">2.9. מבוא לפונקציות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/3_1_builtin-functions.html">2.10. פונקציות מובנות בפייתון</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/3_2_building-functions.html">2.11. בניית פונקציות משלכם</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/3_3_formal-and-actual-variables.html">2.12. פרמטרים וארגומנטים</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/3_5_caller-callee.html">2.13. קריאה הדדית בין פונקציות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/3_4_advanced-examples.html">2.14. דוגמאות מתקדמות</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_3.html">3. שבוע 3 — רשימות ולולאות</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/4_0_intro-list.html">3.2. מבוא לרשימות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/4_1_list-operators-indices.html">3.3. רשימות: אופרטורים בסיסיים ואינדקסים</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/4_2_built-in-functions-in-list.html">3.5. פונקציות מובנות לרשימות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/4_3_list-methods.html">3.6. מתודות של רשימות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/4_4_nested_lists.html">3.7. רשימות מקוננות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/4_5_list-examples.html">3.8. דוגמאות מעשיות</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_4.html">4. שבוע 4 — לולאות וזרימת בקרה</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/5_0_intro-loops.html">4.2. מבוא ללולאות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/6_0_for_loops.html">4.3. לולאות for</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/6_1_ranges-and-for.html">4.4. range ולולאות for</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/6_2_for-examples.html">4.5. דוגמאות ל־for</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/6_3_for-summary.html">4.6. סיכום לולאות for</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/7_0_while_loops.html">4.7. לולאות while</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/7_1_while-examples.html">4.8. דוגמאות ל־while</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/8_0_while_vs_for.html">4.9. while לעומת for</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/8_1_break_and_continue.html">4.10. break ו־continue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/8_2_nested_loops.html">4.11. לולאות מקוננות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/8_3_list-comprehensions.html">4.12. List Comprehensions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_5.html">5. שבוע 5 — זיכרון, פונקציות מתקדמות ומבנים בלתי־משתנים</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/10_0_mutable-vs-immutable.html">5.2. Mutable vs Immutable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/10_1_memory-in-functions.html">5.3. זיכרון והתנהגות בפונקציות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/11_0_advanced_function_usage.html">5.4. שימושים מתקדמים בפונקציות</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_6.html">6. שבוע 6 — מבני נתונים וקריאה וכתיבה של מידע</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/12_0_data_structures.html">6.2. מבני נתונים</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/12_1_tuples.html">6.3. Tuples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/12_2_dicts.html">6.4. מילונים (<code class="docutils literal notranslate"><span class="pre">dict</span></code>)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/13_0_string-formats.html">6.6. עיצוב מחרוזות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/13_1_files.html">6.7. קריאה וכתיבה לקבצים</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_7.html">7. שבוע 7 — Numpy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../week_7/7_0_intro_libs.html">7.2. ספריות בפייתון</a></li>

<li class="toctree-l2"><a class="reference internal" href="../week_7/7_1_arrays.html">7.4. Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_7/7_2_arrays_indexing.html">7.5. Arrays — Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_7/7_3_datatypes.html">7.6. Datatypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_7/7_4_array_math.html">7.7. Array Math</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_7/7_5_broadcasting.html">7.8. Broadcasting</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_8.html">8. שבוע 8 — Matplotlib, Probabilities &amp; Histograms</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../week_8/8_1_matplotlib.html">8.2. Matplotlib</a></li>


<li class="toctree-l2"><a class="reference internal" href="../week_8/8_2_example_matplotlib.html">8.5. דוגמה מסכמת — Matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_8/8_3_prob_hists.html">8.6. Probabilities &amp; Histograms</a></li>


</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_9.html">9. שבוע 9 — Numpy מתקדם</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../week_9/9_1_matrix_operations.html">9.2. פעולות מטריציוניות מתקדמות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_9/9_2_linear_system.html">9.3. פתרון מערכות ליניאריות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_9/9_3_eigen_values.html">9.4. ערכים ווקטורים עצמיים</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_9/9_4_SVD.html">9.5. SVD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_9/9_7_exercises.html">9.6. תרגול עצמי</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_9/9_5_example_image_SVD.html">9.7. תרגול: דחיסת תמונה באמצעות SVD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_9/9_6_example_PI_MC.html">9.8. תרגול: הערכת π בשיטת מונטה־קרלו</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_10.html">10. שבוע 10 — SciPy ומבוא לPandas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../week_10/10_1_physical_consts.html">10.2. קבועים פיזיקליים ויחידות</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_10/10_2_integration.html">10.3. אינטגרציה נומרית</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_10/10_3_optimization.html">10.4. אופטימיזציה</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_0_intro.html">10.5. מבוא - Pandas</a></li>

<li class="toctree-l2"><a class="reference internal" href="11_1_data_structures.html">10.7. Series ו־DataFrame</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_2_io.html">10.8. טעינה וכתיבה של נתונים (I/O)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_10/10_5_example_MB.html">10.9. תרגול: התפלגות מהירות מקסוול–בולצמן (MB)</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_11.html">11. שבוע 11 — Pandas מתקדם</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="11_3_indexing_select_filter.html">11.2. מיון, סינון ואינדוקס נתונים</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_4_cleaning_type_handling.html">11.3. ניקוי נתונים וטיפוסים</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_5_vector_transform.html">11.4. טרנספורמציות ווקטוריות</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_6_grouping_aggregation.html">11.5. קיבוץ וצבירה בנתונים ניסיוניים (Grouping &amp; Aggregation)</a></li>

<li class="toctree-l2"><a class="reference internal" href="11_7_reshaping_dataframes.html">11.7. Reshaping DataFrames</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_8_merging_joining.html">11.8. Merging &amp; Joining</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_9_time_series.html">11.9. ניתוח סדרות זמן בניסויים פיזיקליים (Time Series Essentials)</a></li>

<li class="toctree-l2"><a class="reference internal" href="11_10_exploration_quick_plots.html">11.11. Exploration &amp; Quick Plots</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_12.html">12. שבוע 12 — OOP &amp; Unittesting</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/17_0_oop-intro.html">12.2. מבוא ל־OOP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vendor/virtual-pyprog/17_1_oop-implementation.html">12.3. תחביר מחלקה בפייתון</a></li>




<li class="toctree-l2"><a class="reference internal" href="../week_12/12_1_unittesting_intro.html">12.8. מבוא ל־Unit Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_12/12_2_setup_teardown_edges.html">12.9. setUp/tearDown ושוליים</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_12/12_3_unittesting_oop.html">12.10. בדיקות ל־OOP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_12/12_4_physicsl_unittesting.html">12.11. בדיקות לקוד נומרי בפיזיקה</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/TauInnov/CFS/master?urlpath=lab/tree/course/weeks/week_11/11_week_tutorial.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/TauInnov/CFS/blob/master/course/weeks/week_11/11_week_tutorial.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/TauInnov/CFS" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/TauInnov/CFS/issues/new?title=Issue%20on%20page%20%2Fcourse/weeks/week_11/11_week_tutorial.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/course/weeks/week_11/11_week_tutorial.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>מדידת תאוצת הכובד בעזרת מטוטלת חכמה</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">מדידת תאוצת הכובד בעזרת מטוטלת חכמה</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">רקע ומוטיבציה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">המודל הפיזיקלי</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">תנודות קטנות של מטוטלת פשוטה</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">תיקון לזוויות שאינן קטנות</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">דעיכה (חיכוך ואיבודי אנרגיה)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">מטרה ניסויית</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">קבצי הנתונים</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">שאלת המחקר</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">📊 חלק 1 — הכנת הנתונים וצעדים ראשוניים בניתוח</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">מבנה הנתונים</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pendulum-timeseries-csv">1. <strong>pendulum_timeseries.csv</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trials-csv">2. <strong>trials.csv</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sensors-csv">3. <strong>sensors.csv</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">שלבים 1–2: טעינת הנתונים ובדיקות תקינות בסיסיות</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-cleaning">שלב 3: ניקוי נתוני הסדרה הזמנית (Time-Series Cleaning)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">שלב 4: מיזוג נתוני המדידה עם נתוני המטא־דאטה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">שלב 5: תיקון כיול והכנת שדות פיזיקליים לחישוב</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sanity-checks">שלב 6: בדיקות תקינות מבניות מהירות (Sanity Checks)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">שלב 7: סיכום טווח הזמן לכל ניסוי ובדיקת קצב הדגימה</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">מבנה הנתונים:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-engineering">חלק 2: הנדסת מאפיינים (Feature Engineering) – חישוב זמן מחזור והערכת תאוצת הכובד</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">השלבים העיקריים:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">שלב 1: המרת יחידות זווית למידות רדיאנים</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#period-detection">שלב 2: חישוב זמני מחזור לניסוי בודד (Period Detection)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">מה עושה הפונקציה בפועל:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">תוצאת הפונקציה:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">שלב 3: חישוב זמני מחזור לכל הניסויים</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">מה מתבצע כאן:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">התוצאה:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">שלב 4: חישוב סטטיסטיקות זמן מחזור לכל ניסוי</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">חלק א’ – חישוב מדדים סטטיסטיים</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-rate">חלק ב’ – חישוב קצב הדגימה המשוער (Sampling Rate)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">תוצאה:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#g">שלב 5: אומדן <span class="math notranslate nohighlight">\(g\)</span> לכל ניסוי עם אי־ודאות (הפצת שגיאה)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">אי־ודאות במדידות</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#first-order">הפצת שגיאה (First-order)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">רווח סמך 95%</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">שלב 6: הצגת התוצאות הסופיות</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">חלק א’ — סטטיסטיקות זמן המחזור</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">חלק ב’ — אומדן תאוצת הכובד ורווחי אמון</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-g">חלק 3: ניתוח (Analysis) – השוואת <span class="math notranslate nohighlight">\(g\)</span>, שינוי צורה, ובדיקת תוקף ההנחות</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">השלבים העיקריים</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">תוצרים מרכזיים</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas">שלב 1: ניתוח והשוואה באמצעות Pandas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id34">שלבי הניתוח:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bar-t">שלב 2: שינוי צורה – טבלת ציר של <span class="math notranslate nohighlight">\(\bar{T}\)</span> לפי ניסוי ואורך המטוטלת</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id35">שלב 3: ולידציה – בדיקת הקשר בין זמן המחזור לזווית השחרור</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="id1">
<h1>מדידת תאוצת הכובד בעזרת מטוטלת חכמה<a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
<section id="id2">
<h2>רקע ומוטיבציה<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>מדידת תאוצת הכובד <span class="math notranslate nohighlight">\(g\)</span> היא אחד הניסויים הקלאסיים והאלגנטיים בפיזיקה.<br />
בעזרת מטוטלת פשוטה — חוט באורך <span class="math notranslate nohighlight">\(L\)</span> ומשקולת בקצהו — ניתן לאמוד את <span class="math notranslate nohighlight">\(g\)</span> מתוך מדידה של <strong>זמן המחזור</strong> של התנודה.<br />
בפרויקט זה נשתמש בנתוני חיישן (IMU) סינתטיים כדי להעריך את <span class="math notranslate nohighlight">\(g\)</span>, לבחון את תוקף הנחת הזוויות הקטנות, ולהעריך את אי־הוודאות הנובעת ממדידות חוזרות.</p>
</section>
<section id="id3">
<h2>המודל הפיזיקלי<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<section id="id4">
<h3>תנודות קטנות של מטוטלת פשוטה<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>כאשר הזווית ההתחלתית קטנה (ביחידות רדיאנים), משוואת התנועה של המטוטלת ניתנת לקירוב ליניארי:</p>
<div class="math notranslate nohighlight">
\[
\theta''(t) + \frac{g}{L} \theta(t) = 0
\]</div>
<p>הפתרון הוא תנודה הרמונית פשוטה בתדירות:</p>
<div class="math notranslate nohighlight">
\[
\omega_0 = \sqrt{\frac{g}{L}}
\]</div>
<p>ולכן זמן המחזור של התנודה הוא:</p>
<div class="math notranslate nohighlight">
\[
T = 2\pi \sqrt{\frac{L}{g}}
\]</div>
<p>ומכאן מתקבלת נוסחה לאמידת <span class="math notranslate nohighlight">\(g\)</span>:</p>
<div class="math notranslate nohighlight">
\[
g = \frac{4\pi^2 L}{T^2}
\]</div>
</section>
<section id="id5">
<h3>תיקון לזוויות שאינן קטנות<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>כאשר הזווית ההתחלתית גדולה יותר, זמן המחזור מתארך במעט. ניתן להשתמש בתיקון מסדר שני לפי פיתוח טורי של אינטגרל אליפטי:</p>
<div class="math notranslate nohighlight">
\[
T(\theta_0) \approx T_0 \left( 1 + \frac{\theta_0^2}{16} \right)
\]</div>
<p>כאשר <span class="math notranslate nohighlight">\(T_0\)</span> הוא זמן המחזור בזוויות קטנות, ו־<span class="math notranslate nohighlight">\(\theta_0\)</span> נמדדת ברדיאנים.</p>
</section>
<section id="id6">
<h3>דעיכה (חיכוך ואיבודי אנרגיה)<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>במערכת אמיתית קיימת דעיכה של אמפליטודת התנודה עקב חיכוך באוויר ואיבוד אנרגיה בחיבור החוט.<br />
האמפליטודה מתוארת לרוב על ידי דעיכה מעריכית:</p>
<div class="math notranslate nohighlight">
\[
\theta(t) = \theta_0 e^{-\frac{t}{\tau}} \cos(\omega t)
\]</div>
<p>כאשר <span class="math notranslate nohighlight">\(\tau\)</span> הוא זמן האיפוס (time constant) הקשור לגורם האיכות <span class="math notranslate nohighlight">\(Q\)</span>:</p>
<div class="math notranslate nohighlight">
\[
Q = \pi \frac{\tau}{T}
\]</div>
<p>בפרויקט זה נניח כי החיכוך חלש מספיק כך שזמן המחזור נשאר כמעט קבוע, אך נוכל לבדוק זאת באמצעות ניתוח הנפילות בעוצמת הזווית לאורך זמן.</p>
</section>
</section>
<section id="id7">
<h2>מטרה ניסויית<a class="headerlink" href="#id7" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>להעריך את תאוצת הכובד <span class="math notranslate nohighlight">\(g\)</span></strong> מתוך מדידות חוזרות של זמן המחזור.</p></li>
<li><p><strong>לבדוק את הנחת הזוויות הקטנות</strong> — האם זמן המחזור אכן בלתי תלוי באמפליטודה?</p></li>
<li><p><strong>להעריך את אי־הוודאות</strong> בניסוי מתוך שונות זמני המחזור בין התנודות והמדידות.</p></li>
</ol>
</section>
<section id="id8">
<h2>קבצי הנתונים<a class="headerlink" href="#id8" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pendulum_timeseries.csv</span></code> — נתוני עשרות תנודות עם חיישן IMU (זמן, זווית, תאוצה).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trials.csv</span></code> — נתוני כל ניסוי (אורך המטוטלת, זווית שחרור, טמפרטורה, הערות).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sensors.csv</span></code> — נתוני כיול החיישנים (היסט, רגישות).</p></li>
</ul>
</section>
<section id="id9">
<h2>שאלת המחקר<a class="headerlink" href="#id9" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>האם זמן המחזור של המטוטלת באמת אינו תלוי בזווית השחרור (כל עוד היא קטנה)?<br />
ומהו הערך המדויק ביותר של <span class="math notranslate nohighlight">\(g\)</span> שאנו יכולים להעריך מהנתונים הסינתטיים שלנו?</p>
</div></blockquote>
</section>
</section>
<section id="id10">
<h1>📊 חלק 1 — הכנת הנתונים וצעדים ראשוניים בניתוח<a class="headerlink" href="#id10" title="Link to this heading">#</a></h1>
<p>בשלב זה נגדיר את מבנה הנתונים בפרויקט, נטען את שלושת קבצי ה־CSV, ונבצע מיזוגים ותיקונים ראשוניים שיכינו את הנתונים לניתוח הפיזיקלי.</p>
<section id="id11">
<h2>מבנה הנתונים<a class="headerlink" href="#id11" title="Link to this heading">#</a></h2>
<section id="pendulum-timeseries-csv">
<h3>1. <strong>pendulum_timeseries.csv</strong><a class="headerlink" href="#pendulum-timeseries-csv" title="Link to this heading">#</a></h3>
<p>נתוני מדידה בזמן (time-series) עבור כל ניסוי:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>עמודה</p></th>
<th class="head text-left"><p>תיאור</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">trial_id</span></code></p></td>
<td class="text-left"><p>מזהה ניסוי ייחודי</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">t</span></code></p></td>
<td class="text-left"><p>זמן (שניות או timestamp)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">theta_deg</span></code></p></td>
<td class="text-left"><p>זווית המטוטלת במעלות</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">omega</span></code></p></td>
<td class="text-left"><p>מהירות זוויתית (rad/s), אופציונלי</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">sensor_ax</span></code></p></td>
<td class="text-left"><p>תאוצה נמדדת (m/s²), אופציונלי</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="trials-csv">
<h3>2. <strong>trials.csv</strong><a class="headerlink" href="#trials-csv" title="Link to this heading">#</a></h3>
<p>נתוני מטה-מידע על כל ניסוי:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>עמודה</p></th>
<th class="head text-left"><p>תיאור</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">trial_id</span></code></p></td>
<td class="text-left"><p>מזהה ניסוי</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">L_m</span></code></p></td>
<td class="text-left"><p>אורך המטוטלת במטרים</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">release_angle_deg</span></code></p></td>
<td class="text-left"><p>זווית השחרור ההתחלתית</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">sensor_id</span></code></p></td>
<td class="text-left"><p>מזהה חיישן</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">room_temp_C</span></code></p></td>
<td class="text-left"><p>טמפרטורת חדר</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">notes</span></code></p></td>
<td class="text-left"><p>הערות כלליות</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="sensors-csv">
<h3>3. <strong>sensors.csv</strong><a class="headerlink" href="#sensors-csv" title="Link to this heading">#</a></h3>
<p>נתוני כיול החיישנים:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>עמודה</p></th>
<th class="head text-left"><p>תיאור</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">sensor_id</span></code></p></td>
<td class="text-left"><p>מזהה חיישן</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">theta_offset_deg</span></code></p></td>
<td class="text-left"><p>היסט בזווית המדידה</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">gain</span></code></p></td>
<td class="text-left"><p>גורם רגישות (כפולה/חלוקה במדידה)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="id12">
<h2>שלבים 1–2: טעינת הנתונים ובדיקות תקינות בסיסיות<a class="headerlink" href="#id12" title="Link to this heading">#</a></h2>
<p>בשלב זה אנו טוענים את שלושת מקורות הנתונים לקובצי <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> של Pandas ומוודאים באופן מהיר שהקבצים נקראו כהלכה:</p>
<ol class="arabic simple">
<li><p><strong>טעינת הנתונים</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pendulum_timeseries.csv</span></code> נטען כך שהעמודה <code class="docutils literal notranslate"><span class="pre">t</span></code> נשארת <strong>עמודת שניות נומרית</strong> (לא <code class="docutils literal notranslate"><span class="pre">datetime</span></code>). זה חשוב כי בהמשך נחשב מחזורים וקצבי דגימה מתוך שניות.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trials.csv</span></code> ו־<code class="docutils literal notranslate"><span class="pre">sensors.csv</span></code> נטענים כפי שהם, וישמשו אותנו למטא־דאטה ולנתוני הכיול בהתאמה.</p></li>
<li><p>מיד לאחר הטעינה מוצגת הצצה (<code class="docutils literal notranslate"><span class="pre">head</span></code>) לשלוש הטבלאות, כדי לוודא את מבנה העמודות והערכים הראשונים.</p></li>
</ul>
</li>
<li><p><strong>בדיקות תקינות בסיסיות (Sanity Checks)</strong></p>
<ul class="simple">
<li><p>הדפסת מספר הניסויים הייחודיים (לפי <code class="docutils literal notranslate"><span class="pre">trial_id</span></code>) מתוך <code class="docutils literal notranslate"><span class="pre">trials</span></code> בודקת שאין כפילויות חריגות ברמת הניסוי.</p></li>
<li><p>הדפסת מספר החיישנים הייחודיים (לפי <code class="docutils literal notranslate"><span class="pre">sensor_id</span></code>) מתוך <code class="docutils literal notranslate"><span class="pre">sensors</span></code> בודקת שהכיולים קיימים ושמותאמים לניסויים.</p></li>
<li><p>הדפסת מספר השורות הכולל בטבלת הסדרה הזמנית (<code class="docutils literal notranslate"><span class="pre">timeseries</span></code>) נותנת אינדיקציה ראשונית להיקף הדאטה ולכך שהקריאה לקובץ הצליחה.</p></li>
</ul>
</li>
</ol>
<p>בדיקות אלה מספקות “תאימות בסיסית” לפני כניסה לניקוי, מיזוג וכיול — אם המספרים נראים סבירים והעמודות מופיעות כמצופה, אפשר להמשיך בבטחה לשלב הבא.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># --- 1) Load (keep &#39;t&#39; as a regular numeric/float column) ---</span>
<span class="c1"># IMPORTANT: do NOT parse &#39;t&#39; as dates; it&#39;s seconds</span>
<span class="n">timeseries</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/pendulum_timeseries.csv&quot;</span><span class="p">)</span>   <span class="c1"># ← no parse_dates=[&quot;t&quot;]</span>
<span class="n">trials</span>     <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/trials.csv&quot;</span><span class="p">)</span>
<span class="n">sensors</span>    <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/sensors.csv&quot;</span><span class="p">)</span>

<span class="c1"># Preview first rows</span>
<span class="n">display</span><span class="p">(</span><span class="n">timeseries</span><span class="o">.</span><span class="n">head</span><span class="p">(),</span> <span class="n">trials</span><span class="o">.</span><span class="n">head</span><span class="p">(),</span> <span class="n">sensors</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># --- 2) Basic sanity checks (lightweight) ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Trials:&quot;</span><span class="p">,</span> <span class="n">trials</span><span class="p">[</span><span class="s2">&quot;trial_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sensors:&quot;</span><span class="p">,</span> <span class="n">sensors</span><span class="p">[</span><span class="s2">&quot;sensor_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total time-series samples:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">timeseries</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">6</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># --- 1) Load (keep &#39;t&#39; as a regular numeric/float column) ---</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="c1"># IMPORTANT: do NOT parse &#39;t&#39; as dates; it&#39;s seconds</span>
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="n">timeseries</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/pendulum_timeseries.csv&quot;</span><span class="p">)</span>   <span class="c1"># ← no parse_dates=[&quot;t&quot;]</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">trials</span>     <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/trials.csv&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">sensors</span>    <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/sensors.csv&quot;</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py:1026,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)</span>
<span class="g g-Whitespace">   </span><span class="mi">1013</span> <span class="n">kwds_defaults</span> <span class="o">=</span> <span class="n">_refine_defaults_read</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1014</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1015</span>     <span class="n">delimiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>   <span class="mi">1022</span>     <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1023</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1024</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1026</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py:620,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">617</span> <span class="n">_validate_names</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">619</span> <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">620</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">622</span> <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">623</span>     <span class="k">return</span> <span class="n">parser</span>

<span class="nn">File ~/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py:1620,</span> in <span class="ni">TextFileReader.__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1617</span>     <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1619</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1620</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.12/site-packages/pandas/io/parsers/readers.py:1880,</span> in <span class="ni">TextFileReader._make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1878</span>     <span class="k">if</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1879</span>         <span class="n">mode</span> <span class="o">+=</span> <span class="s2">&quot;b&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1880</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1881</span>     <span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1882</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1883</span>     <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1884</span>     <span class="n">compression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1885</span>     <span class="n">memory_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1886</span>     <span class="n">is_text</span><span class="o">=</span><span class="n">is_text</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1887</span>     <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding_errors&quot;</span><span class="p">,</span> <span class="s2">&quot;strict&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1888</span>     <span class="n">storage_options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1889</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1890</span> <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1891</span> <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="o">.</span><span class="n">handle</span>

<span class="nn">File ~/.local/lib/python3.12/site-packages/pandas/io/common.py:873,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">868</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">869</span>     <span class="c1"># Check whether the filename is to be opened in binary mode.</span>
<span class="g g-Whitespace">    </span><span class="mi">870</span>     <span class="c1"># Binary mode does not support &#39;encoding&#39; and &#39;newline&#39;.</span>
<span class="g g-Whitespace">    </span><span class="mi">871</span>     <span class="k">if</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">and</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">872</span>         <span class="c1"># Encoding</span>
<span class="ne">--&gt; </span><span class="mi">873</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">874</span>             <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">875</span>             <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">876</span>             <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">877</span>             <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">878</span>             <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">879</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">880</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">881</span>         <span class="c1"># Binary mode</span>
<span class="g g-Whitespace">    </span><span class="mi">882</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;data/pendulum_timeseries.csv&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="time-series-cleaning">
<h2>שלב 3: ניקוי נתוני הסדרה הזמנית (Time-Series Cleaning)<a class="headerlink" href="#time-series-cleaning" title="Link to this heading">#</a></h2>
<p>לפני שנשלב את הנתונים עם טבלאות המטא־דאטה, חשוב לוודא שטבלת המדידות (<code class="docutils literal notranslate"><span class="pre">timeseries</span></code>) נקייה,<br />
ממוינת, וללא כפילויות או ערכים חסרים.</p>
<ol class="arabic simple">
<li><p><strong>מיון לפי מזהה ניסוי וזמן (<code class="docutils literal notranslate"><span class="pre">trial_id</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code>)</strong><br />
כך נבטיח שהמדידות מוצגות בסדר כרונולוגי לכל ניסוי,<br />
מה שמקל על חישוב מחזורים וזמני תנודה בהמשך.</p></li>
<li><p><strong>הסרת כפילויות לפי <code class="docutils literal notranslate"><span class="pre">(trial_id,</span> <span class="pre">t)</span></code></strong><br />
במידה וחלק מהמדידות מופיעות פעמיים באותו זמן,<br />
נשמור רק את ההופעה הראשונה כדי למנוע טעויות חישוב.</p></li>
<li><p><strong>הסרת ערכים חסרים (<code class="docutils literal notranslate"><span class="pre">NaN</span></code>)</strong><br />
נוודא שאין ערכים חסרים בעמודות הקריטיות: מזהה ניסוי, זמן, וזווית.<br />
ערכים כאלה עלולים לשבש מיזוגים או ניתוחים פיזיקליים.</p></li>
<li><p><strong>בדיקת ייחודיות (Assertion)</strong><br />
נוודא שאין כפילויות באינדקס (אם קיימת עמודת אינדקס),<br />
כדי לוודא שכל מדידה מזוהה באופן חד־משמעי בזמן ובניסוי שלה.</p></li>
</ol>
<p>לאחר ניקוי זה, הנתונים זמינים ובטוחים לשלב המיזוג עם טבלאות המטא־דאטה.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- 3) Clean time-series ---</span>
<span class="c1"># - sort by trial_id and t</span>
<span class="c1"># - drop duplicates by (trial_id, t)</span>
<span class="c1"># - drop obvious NaNs that break the pipeline</span>
<span class="n">timeseries</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">timeseries</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;mergesort&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;theta_deg&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Ensure unique index</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">timeseries</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(),</span> <span class="s2">&quot;Duplicate (trial_id, t) entries found!&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id13">
<h2>שלב 4: מיזוג נתוני המדידה עם נתוני המטא־דאטה<a class="headerlink" href="#id13" title="Link to this heading">#</a></h2>
<p>בשלב זה נחבר בין שלושת מקורות הנתונים שלנו לטבלה מאוחדת אחת (<code class="docutils literal notranslate"><span class="pre">df</span></code>),<br />
כך שכל שורת מדידה תקבל גם את המידע הפיזיקלי והתפעולי הרלוונטי לה.</p>
<ol class="arabic simple">
<li><p><strong>מיזוג עם <code class="docutils literal notranslate"><span class="pre">trials.csv</span></code></strong><br />
כל מדידה (<code class="docutils literal notranslate"><span class="pre">timeseries</span></code>) משויכת לניסוי מסוים לפי מזהה <code class="docutils literal notranslate"><span class="pre">trial_id</span></code>.<br />
באמצעות <code class="docutils literal notranslate"><span class="pre">merge(...,</span> <span class="pre">validate=&quot;m:1&quot;)</span></code> אנחנו מאשרים שכל ניסוי מופיע פעם אחת בלבד<br />
בטבלת הניסויים — כלומר, מיזוג מסוג “רבים לאחד”.</p></li>
<li><p><strong>מיזוג עם <code class="docutils literal notranslate"><span class="pre">sensors.csv</span></code></strong><br />
לאחר מכן נוסיף את נתוני הכיול של החיישן (<code class="docutils literal notranslate"><span class="pre">sensor_id</span></code>),<br />
כדי שנוכל לתקן את המדידות לפי היסט ורגישות החיישן.</p></li>
<li><p><strong>בדיקת הצלחת המיזוג</strong><br />
נוודא שכל מדידה באמת קיבלה חיישן מתאים — כלומר,<br />
שאין שורות שבהן <code class="docutils literal notranslate"><span class="pre">sensor_id</span></code> ריק או חסר.<br />
אם יש בעיה במיפוי בין הטבלאות, תתקבל הודעת שגיאה ברורה.</p></li>
</ol>
<p>בסוף שלב זה מתקבלת טבלה מאוחדת (<code class="docutils literal notranslate"><span class="pre">df</span></code>) המכילה את כל המידע הפיזיקלי הדרוש<br />
לכל דגימה בזמן, כולל פרטי הניסוי והחיישן.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- 4) Merge with metadata ---</span>
<span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">timeseries</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">trials</span><span class="p">,</span>  <span class="n">on</span><span class="o">=</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;m:1&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sensors</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;sensor_id&quot;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;m:1&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Ensure merge success</span>
<span class="k">assert</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;sensor_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s2">&quot;Some rows are missing matching sensor_id!&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id14">
<h2>שלב 5: תיקון כיול והכנת שדות פיזיקליים לחישוב<a class="headerlink" href="#id14" title="Link to this heading">#</a></h2>
<p>בשלב זה ניישם את תיקוני הכיול של החיישנים וניצור עמודות חדשות שמתאימות לעיבוד פיזיקלי:</p>
<ol class="arabic">
<li><p><strong>תיקון זווית המדידה</strong><br />
כל חיישן עשוי למדוד זוויות עם היסט (offset) או רגישות שונה (gain).<br />
לכן נחשב את הזווית המתוקנת לפי הנוסחה:</p>
<div class="math notranslate nohighlight">
\[
   \theta_{\text{corr}} = (\theta_{\text{raw}} - \text{offset}) \times \text{gain}
   \]</div>
<p>כך נבטיח שכל המדידות מבוססות על אותה סקאלה.</p>
</li>
<li><p><strong>סינון מדידות לא פיזיקליות</strong><br />
נוריד ערכים קיצוניים — לדוגמה, מדידות שבהן הזווית גדולה מ־<span class="math notranslate nohighlight">\(90^\circ\)</span> או קטנה מ־<span class="math notranslate nohighlight">\(-90^\circ\)</span>,<br />
מאחר והן אינן סבירות עבור מטוטלת פשוטה.</p></li>
<li><p><strong>המרת זווית למידות רדיאנים</strong><br />
לצורך ניתוח פיזיקלי ונוסחאות מתמטיות נשתמש בזוויות ברדיאנים.<br />
לכן ניצור עמודה חדשה <code class="docutils literal notranslate"><span class="pre">theta_rad</span></code>:</p>
<div class="math notranslate nohighlight">
\[
   \theta_{\text{rad}} = \text{deg2rad}(\theta_{\text{corr}})
   \]</div>
</li>
</ol>
<p>לאחר שלב זה, כל הנתונים הזוויתיים במערכת מאוחדים, מתוקנים ומוכנים לניתוח.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- 5) Apply calibration and physics-friendly fields ---</span>
<span class="c1"># theta_corr_deg = (raw - offset) * gain</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;theta_corr_deg&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;theta_deg&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;theta_offset_deg&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;gain&quot;</span><span class="p">]</span>

<span class="c1"># Drop unrealistic angles (keep physically plausible range)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;theta_corr_deg&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">)]</span>

<span class="c1"># Radians for further math</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;theta_rad&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;theta_corr_deg&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="sanity-checks">
<h2>שלב 6: בדיקות תקינות מבניות מהירות (Sanity Checks)<a class="headerlink" href="#sanity-checks" title="Link to this heading">#</a></h2>
<p>לפני שנמשיך לשלב הניתוח הפיזיקלי, חשוב לוודא שהנתונים המאוחדים שלנו תקינים מבנית.<br />
מטרת החלק הזה היא לבצע <strong>בדיקות מהירות (assertions)</strong> שמאשרות שהטבלה <code class="docutils literal notranslate"><span class="pre">df</span></code> נראית סבירה ועומדת בדרישות הבסיסיות.</p>
<ol class="arabic simple">
<li><p><strong>בדיקת עמודות חובה</strong><br />
נוודא שכל העמודות הקריטיות קיימות בטבלה:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trial_id</span></code> – מזהה ניסוי</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> – הזמן של כל מדידה</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">theta_rad</span></code> – הזווית המתוקנת ברדיאנים</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">L_m</span></code> – אורך המטוטלת במטרים</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sensor_id</span></code> – מזהה החיישן<br />
אם אחת מהעמודות חסרה, הקוד יעצור מיד עם הודעת שגיאה ברורה.</p></li>
</ul>
</li>
<li><p><strong>בדיקת כמות הדגימות לכל ניסוי</strong><br />
נוודא שכל ניסוי מכיל מספיק מדידות (ברירת המחדל: לפחות 50 דגימות).<br />
ניסוי עם פחות דגימות עלול להיות קצר מדי ולא לאפשר ניתוח אמין של זמן המחזור.</p></li>
</ol>
<p>בדיקות אלו פועלות כמו “בקרת איכות” לפני שמתקדמים –<br />
אם הן עוברות בהצלחה, ניתן להיות בטוחים שהנתונים מוכנים לחישוב זמני המחזור ואמידת <span class="math notranslate nohighlight">\(g\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- 6) Minimal structural assertions (fast sanity checks) ---</span>
<span class="c1"># a) required columns exist</span>
<span class="n">required</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;theta_rad&quot;</span><span class="p">,</span> <span class="s2">&quot;L_m&quot;</span><span class="p">,</span> <span class="s2">&quot;sensor_id&quot;</span><span class="p">}</span>
<span class="k">assert</span> <span class="n">required</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Missing expected columns: </span><span class="si">{</span><span class="n">required</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># b) each trial has enough samples (you can tune the threshold)</span>
<span class="n">sample_counts</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;trial_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">sample_counts</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="sa">f</span><span class="s2">&quot;Some trials have too few samples:</span><span class="se">\n</span><span class="si">{</span><span class="n">sample_counts</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id15">
<h2>שלב 7: סיכום טווח הזמן לכל ניסוי ובדיקת קצב הדגימה<a class="headerlink" href="#id15" title="Link to this heading">#</a></h2>
<p>בחלק זה נבצע בדיקה פשוטה שמוודאת שהנתונים הסינתטיים שלנו “נראים הגיוניים בזמן”.<br />
כל ניסוי (trial) נמדד לאורך זמן – ולכן נרצה לראות עבור כל מזהה ניסוי:</p>
<ul class="simple">
<li><p>את זמן ההתחלה (<strong>min</strong>)</p></li>
<li><p>את זמן הסיום (<strong>max</strong>)</p></li>
<li><p>את מספר הדגימות הכולל (<strong>count</strong>)</p></li>
<li><p>ואת משך הניסוי (<strong>duration = max - min</strong>)</p></li>
</ul>
<p>כך נוכל לזהות ניסויים קצרים מדי או בעלי חוסר עקביות בזמני הדגימה.<br />
בנוסף נחשב גם את <strong>קצב הדגימה המשוער (sampling rate, ב-Hz)</strong>,<br />
שמתקבל ממספר הדגימות חלקי משך הניסוי.</p>
<p>זהו צעד בדיקה בלבד, שמוודא שהנתונים מוכנים לשלבים הבאים של ניתוח המחזור ואמידת <span class="math notranslate nohighlight">\(g\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- 7) Quick end-of-cell “time coverage” summary per trial (since t is a column) ---</span>
<span class="n">coverage</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;trial_id&quot;</span><span class="p">)[</span><span class="s2">&quot;t&quot;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">])</span>
      <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">s</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">])</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Time coverage per trial:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">coverage</span><span class="p">)</span>

<span class="c1"># (Optional) estimate sampling rate per trial (Hz) from span and count</span>
<span class="n">est_fs</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;trial_id&quot;</span><span class="p">)[</span><span class="s2">&quot;t&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Estimated sampling rate (Hz) per trial:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">est_fs</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Time coverage per trial:
          min      max  count  duration
trial_id                               
T01       0.0   7.9900    800    7.9900
T02       0.0  11.9875    960   11.9875
T03       0.0  17.9833   1080   17.9833

Estimated sampling rate (Hz) per trial:
trial_id
T01    100.0
T02     80.0
T03     60.0
Name: t, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>בקובץ <code class="docutils literal notranslate"><span class="pre">df</span></code> כעת יש את כל הנתונים המאוחדים, המתוקנים והמסוננים, והוא מייצג את נקודת הסיום של שלב ההכנה.<br />
כל דגימה בזמן (שורה אחת בטבלה) מכילה את כל המידע הפיזיקלי, הניסויי והחיישני הדרוש לניתוח המטוטלת.</p>
<section id="id16">
<h3>מבנה הנתונים:<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>עמודות מזהות:</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">trial_id</span></code> – מזהה הניסוי שאליו שייכת המדידה</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> – הזמן בשניות מרגע תחילת הניסוי</p></li>
</ul>
</li>
<li><p><strong>עמודות פיזיקליות:</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">theta_deg</span></code> – הזווית הגולמית שנמדדה על ידי החיישן</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">theta_corr_deg</span></code> – הזווית המתוקנת לאחר החלת תיקון הכיול (offset + gain)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">theta_rad</span></code> – הזווית המתוקנת ביחידות רדיאנים (לשימוש בנוסחאות פיזיקליות)</p></li>
</ul>
</li>
<li><p><strong>עמודות מטא־דאטה:</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">L_m</span></code> – אורך המטוטלת במטרים</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">release_angle_deg</span></code> – זווית השחרור ההתחלתית של המטוטלת</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">room_temp_C</span></code> – טמפרטורת החדר במהלך הניסוי</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sensor_id</span></code> – מזהה החיישן ששימש למדידה</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gain</span></code>, <code class="docutils literal notranslate"><span class="pre">theta_offset_deg</span></code> – פרטי הכיול הספציפיים של אותו חיישן</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">notes</span></code> – הערות כלליות או תצפיות על הניסוי</p></li>
</ul>
</li>
</ul>
<p>בסיום שלב זה הנתונים נקיים, עקביים ומאוחדים תחת מבנה אחיד אחד (<code class="docutils literal notranslate"><span class="pre">df</span></code>),<br />
כך שכל ניתוח פיזיקלי בהמשך (כגון זיהוי תנודות, חישוב זמן מחזור, או אמידת תאוצת הכובד <span class="math notranslate nohighlight">\(g\)</span>)<br />
יכול להתבסס ישירות עליו מבלי להזדקק למיזוגים נוספים או לניקוי נוסף.</p>
<p>במילים אחרות — קובץ <code class="docutils literal notranslate"><span class="pre">df</span></code> הוא <strong>בסיס הנתונים הראשי של הניסוי</strong> ממנו נגזור את כל המדדים הבאים.</p>
</section>
</section>
</section>
<section id="feature-engineering">
<h1>חלק 2: הנדסת מאפיינים (Feature Engineering) – חישוב זמן מחזור והערכת תאוצת הכובד<a class="headerlink" href="#feature-engineering" title="Link to this heading">#</a></h1>
<p>בשלב זה נבצע את עיבוד האות הפיזיקלי מתוך נתוני הזווית של המטוטלת (<code class="docutils literal notranslate"><span class="pre">theta</span></code>)<br />
ונחשב עבור כל ניסוי את <strong>זמן המחזור הממוצע</strong>, את סטיית התקן, ואת אמידת תאוצת הכובד <span class="math notranslate nohighlight">\(g\)</span>.<br />
המטרה היא לעבור מהמידע הגולמי — אות תנודה בזמן — לסט מאפיינים פיזיקליים בעלי משמעות.</p>
<section id="id17">
<h2>השלבים העיקריים:<a class="headerlink" href="#id17" title="Link to this heading">#</a></h2>
<ol class="arabic">
<li><p><strong>ניקוי וסינון האות (Detrend &amp; Smooth)</strong><br />
נשתמש בגלגול ממוצע (<code class="docutils literal notranslate"><span class="pre">rolling</span> <span class="pre">mean</span></code>) כדי להסיר רעשי מדידה ולהחליק את האות,<br />
כך שנוכל לזהות את נקודות החצייה של הציר (zero-crossings) בצורה אמינה.</p></li>
<li><p><strong>זיהוי מחזורים (Period Detection)</strong><br />
נחשב את נקודות המעבר של הזווית מ־שלילית לחיובית (חצייה כלפי מעלה),<br />
ונמדוד את ההפרש הזמני ביניהן — זהו זמן המחזור של תנודה אחת.<br />
לאחר מכן נסיר חריגים בעזרת סינון סביב החציון כדי להבטיח יציבות.</p></li>
<li><p><strong>אגרגציה לכל ניסוי</strong><br />
נחשב לכל ניסוי את:</p>
<ul class="simple">
<li><p>הזמן הממוצע למחזור <span class="math notranslate nohighlight">\(\bar{T}\)</span></p></li>
<li><p>סטיית התקן <span class="math notranslate nohighlight">\(σ_T\)</span></p></li>
<li><p>מספר המחזורים שזוהו</p></li>
</ul>
<p>כל אלה נשמרים בטבלה <code class="docutils literal notranslate"><span class="pre">period_stats</span></code>.</p>
</li>
<li><p><strong>חישוב תאוצת הכובד <span class="math notranslate nohighlight">\(g\)</span></strong><br />
לפי נוסחת המטוטלת בזוויות קטנות:</p>
<div class="math notranslate nohighlight">
\[
   g = \frac{4 \pi^2 L}{T^2}
   \]</div>
<p>נשתמש באורך המטוטלת <span class="math notranslate nohighlight">\(L_m\)</span> ובזמן המחזור הממוצע <span class="math notranslate nohighlight">\(\bar{T}\)</span> כדי להעריך את <span class="math notranslate nohighlight">\(g\)</span> לכל ניסוי.</p>
</li>
<li><p><strong>הערכת אי־ודאות וגבולות אמון (Confidence Intervals)</strong><br />
נחשב את טעות המדידה המתקבלת משגיאות באורך המטוטלת ובמדידת המחזור,<br />
נבצע הפצת אי־ודאות לפי הנגזרות החלקיות,<br />
ונפיק טווח אמון של 95% סביב כל ערך <span class="math notranslate nohighlight">\(g\)</span>.</p></li>
</ol>
<p>לאחר שלב זה, נוכל להשוות בין הניסויים, לבדוק את ההשפעה של אורך המטוטלת וזווית השחרור,<br />
ולוודא שהערכים המתקבלים של <span class="math notranslate nohighlight">\(g\)</span> מתכנסים סביב הערך התאורטי <span class="math notranslate nohighlight">\(9.81 \text{ m/s}^2\)</span>.</p>
</section>
<section id="id18">
<h2>שלב 1: המרת יחידות זווית למידות רדיאנים<a class="headerlink" href="#id18" title="Link to this heading">#</a></h2>
<p>בשלב זה נוודא כי בעמודת הנתונים קיימים ערכי הזווית ביחידות <strong>רדיאנים</strong>,<br />
כיוון שזו היחידה הפיזיקלית הנכונה לביצוע חישובים טריגונומטריים ולניתוח תנודות.</p>
<ul>
<li><p>אם בעמודת הנתונים כבר קיימת עמודה בשם <code class="docutils literal notranslate"><span class="pre">theta_rad</span></code> — נשתמש בה כפי שהיא.</p></li>
<li><p>אם קיימת רק עמודת זוויות במעלות (<code class="docutils literal notranslate"><span class="pre">theta_deg</span></code>) — נמיר אותה לרדיאנים בעזרת הנוסחה:</p>
<div class="math notranslate nohighlight">
\[
  \theta_{\text{rad}} = \theta_{\text{deg}} \times \frac{\pi}{180}
  \]</div>
</li>
<li><p>במידה ואין אף אחת מהעמודות הללו, נזרוק שגיאה שמודיעה למשתמש כי יש צורך לספק לפחות אחת מהן.</p></li>
</ul>
<p>המרה זו שומרת את עמודת הזמן <code class="docutils literal notranslate"><span class="pre">t</span></code> כעמודה רגילה (לא אינדקס),<br />
כך שנוכל להמשיך להשתמש בה בקלות לצורך חישוב מחזורים, גרפים וסטטיסטיקות.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># --- 0) Preconditions ---</span>
<span class="n">req</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;L_m&quot;</span><span class="p">}</span>
<span class="n">missing</span> <span class="o">=</span> <span class="n">req</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="k">if</span> <span class="n">missing</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;df is missing required columns: </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;t&#39; must be numeric seconds (not datetime).&quot;</span><span class="p">)</span>

<span class="c1"># --- 1) Make sure radians are available (keeps &#39;t&#39; as a regular numeric column) ---</span>
<span class="k">if</span> <span class="s2">&quot;theta_rad&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="s2">&quot;theta_deg&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Provide either &#39;theta_rad&#39; or &#39;theta_deg&#39;.&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;theta_rad&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;theta_deg&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="period-detection">
<h2>שלב 2: חישוב זמני מחזור לניסוי בודד (Period Detection)<a class="headerlink" href="#period-detection" title="Link to this heading">#</a></h2>
<p>בשלב זה אנו מגדירים פונקציה <code class="docutils literal notranslate"><span class="pre">periods_for_group()</span></code> שמבצעת את ניתוח האות עבור <strong>ניסוי אחד בלבד</strong><br />
ומחזירה את זמני המחזור (הפרשי הזמן בין תנודות עוקבות).<br />
הפונקציה עושה שימוש ביכולות הנפוצות של Pandas בלבד — ללא ספריות חיצוניות.</p>
<section id="id19">
<h3>מה עושה הפונקציה בפועל:<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<ol class="arabic">
<li><p><strong>מיון לפי זמן (<code class="docutils literal notranslate"><span class="pre">t</span></code>)</strong><br />
כדי לוודא שהמדידות מנותחות בסדר כרונולוגי נכון.</p></li>
<li><p><strong>אומדן קצב הדגימה (<code class="docutils literal notranslate"><span class="pre">fs</span></code>)</strong><br />
מחושב לפי הנוסחה:</p>
<div class="math notranslate nohighlight">
\[
   f_s = \frac{N - 1}{t_\text{max} - t_\text{min}}
   \]</div>
<p>זהו קצב המדידה (מספר דגימות לשנייה) המשמש לקביעת חלון החלקה מתאים.</p>
</li>
<li><p><strong>החלקה והסרת מגמה (Detrend + Smooth)</strong><br />
משתמשים בחלון מתגלגל (<code class="docutils literal notranslate"><span class="pre">rolling</span> <span class="pre">window</span></code>) שאורכו בערך 0.3 שניות:</p>
<ul class="simple">
<li><p>תחילה מסירים מגמת רקע על ידי חיסור הממוצע המקומי.</p></li>
<li><p>לאחר מכן מחליקים שוב כדי להפחית רעש מדידה ולהבליט את מבנה התנודות.</p></li>
</ul>
</li>
<li><p><strong>זיהוי חציות אפס כלפי מעלה (Rising Zero-Crossings)</strong><br />
האות עובר מ־ערך שלילי או אפס לערך חיובי — זה מציין תחילת מחזור חדש.<br />
בעזרת פעולת <code class="docutils literal notranslate"><span class="pre">shift()</span></code> אנו משווים כל נקודה לנקודה הקודמת ובודקים מתי התרחש המעבר.<br />
כדי לחדד את זמן החצייה המדויק, מבוצעת <strong>אינטרפולציה ליניארית</strong> בין שתי הדגימות שסביב המעבר.</p></li>
<li><p><strong>חישוב זמני המחזור</strong><br />
נחשב את ההפרשים (<code class="docutils literal notranslate"><span class="pre">diff</span></code>) בין זמני חציות עוקבות — כל הפרש מייצג מחזור אחד של המטוטלת.</p></li>
<li><p><strong>סינון חריגים (Outlier Rejection)</strong><br />
מחזורי זמן שאינם סבירים (קצרים מדי או ארוכים מדי ביחס לחציון) מוסרים:<br />
רק ערכים בטווח</p>
<div class="math notranslate nohighlight">
\[
   0.5 \times \tilde{T} \leq T_i \leq 2.0 \times \tilde{T}
   \]</div>
<p>נשמרים, כאשר <span class="math notranslate nohighlight">\(\tilde{T}\)</span> הוא החציון של כל המחזורים.</p>
</li>
</ol>
</section>
<section id="id20">
<h3>תוצאת הפונקציה:<a class="headerlink" href="#id20" title="Link to this heading">#</a></h3>
<p>טבלת Pandas קטנה עם שתי עמודות:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trial_id</span></code> — מזהה הניסוי</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">period_s</span></code> — זמני המחזור שזוהו (בשניות)</p></li>
</ul>
<p>פונקציה זו היא הבסיס לחישוב הסטטיסטיקות הפיזיקליות בהמשך,<br />
כאשר נריץ אותה על כל ניסוי בנפרד באמצעות <code class="docutils literal notranslate"><span class="pre">groupby(&quot;trial_id&quot;).apply(...)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- 2) Helper to compute periods for ONE trial using only pandas ops ---</span>
<span class="k">def</span><span class="w"> </span><span class="nf">periods_for_group</span><span class="p">(</span><span class="n">g</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a DataFrame with columns [trial_id, period_s] for a single trial.</span>
<span class="sd">    Steps (pandas only):</span>
<span class="sd">      - sort by t</span>
<span class="sd">      - rolling mean to detrend &amp; smooth (window ~0.3s of the local sampling rate)</span>
<span class="sd">      - rising zero-crossings via shift()</span>
<span class="sd">      - periods from diff of crossing times</span>
<span class="sd">      - robust outlier clip around the median</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;theta_rad&quot;</span><span class="p">]</span>

    <span class="c1"># Estimate local sampling rate: (N-1) / span</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">t</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># Rolling window in samples (~0.3s), fallback to 21 if fs is unknown; keep odd</span>
    <span class="n">w</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="nb">round</span><span class="p">((</span><span class="n">fs</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">)</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span> <span class="k">else</span> <span class="mi">21</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">w</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Detrend + smooth with rolling mean</span>
    <span class="n">trend</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">smooth</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">trend</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="c1"># Rising zero-crossings (vectorized): x_{i-1} &lt;= 0, x_i &gt; 0</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">smooth</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">smooth</span>
    <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">t</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">x0</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">x1</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x1</span> <span class="o">!=</span> <span class="n">x0</span><span class="p">)</span>

    <span class="c1"># Linear interpolation to get the exact crossing time</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">t_cross</span> <span class="o">=</span> <span class="p">(</span><span class="n">t0</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span><span class="p">))[</span><span class="n">m</span><span class="p">]</span>

    <span class="c1"># Periods = diff between consecutive rising crossings</span>
    <span class="n">periods</span> <span class="o">=</span> <span class="n">t_cross</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">periods</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="s2">&quot;period_s&quot;</span><span class="p">])</span>

    <span class="c1"># Robust outlier rejection around median</span>
    <span class="n">med</span> <span class="o">=</span> <span class="n">periods</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
    <span class="n">keep</span> <span class="o">=</span> <span class="n">periods</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">med</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">med</span><span class="p">)</span>
    <span class="n">periods</span> <span class="o">=</span> <span class="n">periods</span><span class="p">[</span><span class="n">keep</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;trial_id&quot;</span><span class="p">:</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;trial_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;period_s&quot;</span><span class="p">:</span> <span class="n">periods</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()})</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id21">
<h2>שלב 3: חישוב זמני מחזור לכל הניסויים<a class="headerlink" href="#id21" title="Link to this heading">#</a></h2>
<p>בשלב זה נפעיל את הפונקציה <code class="docutils literal notranslate"><span class="pre">periods_for_group()</span></code> שהוגדרה קודם<br />
על כל אחד מהניסויים בנפרד, בעזרת פקודת <code class="docutils literal notranslate"><span class="pre">groupby().apply()</span></code> של Pandas.</p>
<section id="id22">
<h3>מה מתבצע כאן:<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>הנתונים בקובץ <code class="docutils literal notranslate"><span class="pre">df</span></code> מחולקים לפי מזהה הניסוי (<code class="docutils literal notranslate"><span class="pre">trial_id</span></code>),<br />
כך שכל קבוצה מייצגת סדרת מדידות של ניסוי אחד.</p></li>
<li><p>עבור כל קבוצה כזו, מופעלת הפונקציה <code class="docutils literal notranslate"><span class="pre">periods_for_group()</span></code><br />
שמחזירה את זמני המחזור (ביחידות שניות) עבור אותו ניסוי.</p></li>
<li><p>התוצאות מכל הניסויים מאוחדות מחדש לטבלה אחת בשם <code class="docutils literal notranslate"><span class="pre">periods_df</span></code>,<br />
כאשר כל שורה מציינת:</p>
<ul class="simple">
<li><p>מזהה ניסוי (<code class="docutils literal notranslate"><span class="pre">trial_id</span></code>)</p></li>
<li><p>זמן מחזור בודד (<code class="docutils literal notranslate"><span class="pre">period_s</span></code>)</p></li>
</ul>
</li>
<li><p>בסוף התהליך אנו מבצעים <code class="docutils literal notranslate"><span class="pre">reset_index(drop=True)</span></code><br />
כדי לאפס את האינדקס ולקבל טבלה שטוחה ונקייה, נוחה לאגרגציה בהמשך.</p></li>
</ol>
</section>
<section id="id23">
<h3>התוצאה:<a class="headerlink" href="#id23" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">periods_df</span></code> היא טבלה ארוכה (long format) שבה יש כמה עשרות או מאות מחזורים לכל ניסוי.<br />
על בסיס טבלה זו נחשב בהמשך ממוצעים, סטיות תקן ואומדנים לתאוצת הכובד <span class="math notranslate nohighlight">\(g\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- 3) Compute periods for all trials (one apply) ---</span>
<span class="n">periods_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="n">group_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
      <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">periods_for_group</span><span class="p">)</span>
      <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2408/2784985075.py:4: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(periods_for_group)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id24">
<h2>שלב 4: חישוב סטטיסטיקות זמן מחזור לכל ניסוי<a class="headerlink" href="#id24" title="Link to this heading">#</a></h2>
<p>לאחר שחישבנו את זמני המחזור הבודדים (<code class="docutils literal notranslate"><span class="pre">period_s</span></code>) לכל ניסוי,<br />
בשלב זה נבצע <strong>אגרגציה (Aggregation)</strong> — כלומר נחשב מדדים מסכמים לכל ניסוי.</p>
<section id="id25">
<h3>חלק א’ – חישוב מדדים סטטיסטיים<a class="headerlink" href="#id25" title="Link to this heading">#</a></h3>
<p>באמצעות <code class="docutils literal notranslate"><span class="pre">groupby(&quot;trial_id&quot;)</span></code> נרכז את כל זמני המחזור של כל ניסוי ונחשב:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(T_{\text{mean}}\)</span> — זמן המחזור הממוצע (בשניות)</p></li>
<li><p><span class="math notranslate nohighlight">\(T_{\text{std}}\)</span> — סטיית התקן של זמני המחזור (מדד לפיזור התנודות)</p></li>
<li><p><span class="math notranslate nohighlight">\(T_{\text{count}}\)</span> — מספר המחזורים שזוהו בניסוי</p></li>
</ul>
<p>התוצאה נשמרת בטבלה <code class="docutils literal notranslate"><span class="pre">period_stats</span></code>, שבה כל שורה מייצגת ניסוי אחד.</p>
</section>
<section id="sampling-rate">
<h3>חלק ב’ – חישוב קצב הדגימה המשוער (Sampling Rate)<a class="headerlink" href="#sampling-rate" title="Link to this heading">#</a></h3>
<p>לא חובה אך שימושי: נחשב גם את <strong>קצב הדגימה המשוער</strong> (Hz) לכל ניסוי, לפי הנוסחה:</p>
<div class="math notranslate nohighlight">
\[
f_s = \frac{N - 1}{t_{\max} - t_{\min}}
\]</div>
<p>כאשר:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N\)</span> — מספר הדגימות בניסוי</p></li>
<li><p><span class="math notranslate nohighlight">\(t_{\max}, t_{\min}\)</span> — זמני התחלה וסיום של המדידה</p></li>
</ul>
<p>תוצאה זו נשמרת בעמודה חדשה <code class="docutils literal notranslate"><span class="pre">fs_est</span></code>, שמתווספת לטבלה <code class="docutils literal notranslate"><span class="pre">period_stats</span></code> באמצעות <code class="docutils literal notranslate"><span class="pre">merge()</span></code>.</p>
</section>
<section id="id26">
<h3>תוצאה:<a class="headerlink" href="#id26" title="Link to this heading">#</a></h3>
<p>הטבלה <code class="docutils literal notranslate"><span class="pre">period_stats</span></code> כוללת כעת לכל ניסוי את:</p>
<ul class="simple">
<li><p>זמן המחזור הממוצע <span class="math notranslate nohighlight">\(T_{\text{mean}}\)</span></p></li>
<li><p>סטיית התקן <span class="math notranslate nohighlight">\(T_{\text{std}}\)</span></p></li>
<li><p>מספר המחזורים <span class="math notranslate nohighlight">\(T_{\text{count}}\)</span></p></li>
<li><p>קצב הדגימה המשוער <span class="math notranslate nohighlight">\(f_s\)</span></p></li>
</ul>
<p>טבלה זו תשמש אותנו בהמשך לאמידת תאוצת הכובד <span class="math notranslate nohighlight">\(g\)</span> ולחישוב רווחי האמון.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- 4) Aggregate period statistics per trial ---</span>
<span class="n">period_stats</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">periods_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;trial_id&quot;</span><span class="p">)[</span><span class="s2">&quot;period_s&quot;</span><span class="p">]</span>
              <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">T_mean</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">T_std</span><span class="o">=</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="n">T_count</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">)</span>
              <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="p">)</span>

<span class="c1"># (Nice-to-have) Estimated sampling rate per trial (Hz)</span>
<span class="n">fs_est</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">])</span>
      <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;trial_id&quot;</span><span class="p">)[</span><span class="s2">&quot;t&quot;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
             <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
      <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;fs_est&quot;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">period_stats</span> <span class="o">=</span> <span class="n">period_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">fs_est</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="g">
<h2>שלב 5: אומדן <span class="math notranslate nohighlight">\(g\)</span> לכל ניסוי עם אי־ודאות (הפצת שגיאה)<a class="headerlink" href="#g" title="Link to this heading">#</a></h2>
<p>בשלב זה נאמד את תאוצת הכובד <span class="math notranslate nohighlight">\(g\)</span> לכל ניסוי על סמך מודל המטוטלת לזוויות קטנות:</p>
<div class="math notranslate nohighlight">
\[
g \;=\; \frac{4\pi^2\,L}{T^2}
\]</div>
<p>כאשר:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(L\)</span> — אורך המטוטלת במטרים,</p></li>
<li><p><span class="math notranslate nohighlight">\(T\)</span> — זמן המחזור. כאן נשתמש בממוצע המחזורים שנמדדו: <span class="math notranslate nohighlight">\(T_{\text{mean}}\)</span>.</p></li>
</ul>
<section id="id27">
<h3>אי־ודאות במדידות<a class="headerlink" href="#id27" title="Link to this heading">#</a></h3>
<p>נניח אי־ודאות באורך <span class="math notranslate nohighlight">\(L\)</span> קבועה לכל הניסויים (אפשר לשנות לפי הצורך):
$<span class="math notranslate nohighlight">\(
\sigma_L \;=\; 0.005~\text{m}
\)</span>$</p>
<p>את אי־הוודאות של ממוצע הזמן נאמוד בעזרת סטיית־תקן על פי <strong>שגיאת התקן של הממוצע</strong>:
$<span class="math notranslate nohighlight">\(
\sigma_T \;=\; \frac{T_{\text{std}}}{\sqrt{T_{\text{count}}}}
\)</span><span class="math notranslate nohighlight">\(
כאשר אם \)</span>T_{\text{count}}\le 1<span class="math notranslate nohighlight">\( אין משמעות ל־\)</span>\sigma_T<span class="math notranslate nohighlight">\( ולכן נגדיר \)</span>\sigma_T=\mathrm{NaN}$.</p>
</section>
<section id="first-order">
<h3>הפצת שגיאה (First-order)<a class="headerlink" href="#first-order" title="Link to this heading">#</a></h3>
<p>נגזור את <span class="math notranslate nohighlight">\(g(L,T)\)</span> לפי <span class="math notranslate nohighlight">\(L\)</span> ו־<span class="math notranslate nohighlight">\(T\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial g}{\partial L} \;=\; \frac{4\pi^2}{T^2}, \qquad
\frac{\partial g}{\partial T} \;=\; -\,\frac{8\pi^2\,L}{T^3}.
\]</div>
<p>האי־ודאות המשוקללת ב־<span class="math notranslate nohighlight">\(g\)</span> מתקבלת מחיבור ריבועי (בהנחת אי־תלות בין <span class="math notranslate nohighlight">\(L\)</span> ל־<span class="math notranslate nohighlight">\(T\)</span>):</p>
<div class="math notranslate nohighlight">
\[
\sigma_g \;=\; \sqrt{
\left(\frac{\partial g}{\partial L}\right)^2 \sigma_L^2 \;+\;
\left(\frac{\partial g}{\partial T}\right)^2 \sigma_T^2 }.
\]</div>
</section>
<section id="id28">
<h3>רווח סמך 95%<a class="headerlink" href="#id28" title="Link to this heading">#</a></h3>
<p>נחשב רווח סמך בקירוב נורמלי עם <span class="math notranslate nohighlight">\(z=1.96\)</span>:</p>
<div class="math notranslate nohighlight">
\[
g_{\text{low}} \;=\; g_{\text{est}} - 1.96\,\sigma_g, \qquad
g_{\text{high}} \;=\; g_{\text{est}} + 1.96\,\sigma_g.
\]</div>
<p>התוצאה (<code class="docutils literal notranslate"><span class="pre">g_stats</span></code>) כוללת לכל <code class="docutils literal notranslate"><span class="pre">trial_id</span></code> את:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(L\)</span>, <span class="math notranslate nohighlight">\(T_{\text{mean}}\)</span>, <span class="math notranslate nohighlight">\(T_{\text{std}}\)</span>, <span class="math notranslate nohighlight">\(T_{\text{count}}\)</span>,</p></li>
<li><p>אומדן <span class="math notranslate nohighlight">\(g_{\text{est}}\)</span>,</p></li>
<li><p>אי־ודאות <span class="math notranslate nohighlight">\(\sigma_g\)</span>,</p></li>
<li><p>ורווח סמך <span class="math notranslate nohighlight">\([g_{\text{low}},\, g_{\text{high}}]\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- 5) Compute g per trial with uncertainty (error propagation) ---</span>
<span class="c1"># Small-angle pendulum: g = 4*pi^2 * L / T^2</span>
<span class="c1"># Uncertainty:</span>
<span class="c1">#   sigma_T = T_std / sqrt(T_count)   (SE of the mean; NaN if count&lt;=1)</span>
<span class="c1">#   sigma_L = default length uncertainty (set a constant or merge per-trial if known)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># Collect per-trial metadata (length and release angle) from the raw df</span>
<span class="n">trial_meta</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
      <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">L_m</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;L_m&quot;</span><span class="p">,</span> <span class="s2">&quot;first&quot;</span><span class="p">),</span>
           <span class="n">release_angle_deg</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;release_angle_deg&quot;</span><span class="p">,</span> <span class="s2">&quot;first&quot;</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Merge period stats with trial metadata</span>
<span class="n">g_stats</span> <span class="o">=</span> <span class="n">period_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">trial_meta</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>

<span class="n">default_sigma_L</span> <span class="o">=</span> <span class="mf">0.005</span>  <span class="c1"># meters (5 mm)</span>
<span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;sigma_L&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_sigma_L</span>
<span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;sigma_T&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;T_std&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;T_count&quot;</span><span class="p">])</span>
<span class="n">g_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;T_count&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;sigma_T&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>  <span class="c1"># no SE with single sample</span>

<span class="c1"># Gravity estimate</span>
<span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;g_est&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;L_m&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;T_mean&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Error propagation (first-order)</span>
<span class="n">dg_dL</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;T_mean&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">dg_dT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;L_m&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;T_mean&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;sigma_g&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
    <span class="p">(</span><span class="n">dg_dL</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;sigma_L&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
    <span class="p">(</span><span class="n">dg_dT</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;sigma_T&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># 95% confidence interval</span>
<span class="n">z</span> <span class="o">=</span> <span class="mf">1.96</span>
<span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;g_CI_low&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;g_est&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">z</span> <span class="o">*</span> <span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;sigma_g&quot;</span><span class="p">]</span>
<span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;g_CI_high&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;g_est&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">z</span> <span class="o">*</span> <span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;sigma_g&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id29">
<h2>שלב 6: הצגת התוצאות הסופיות<a class="headerlink" href="#id29" title="Link to this heading">#</a></h2>
<p>בשלב זה נדפיס את סיכומי התוצאות משני שלבי הניתוח — סטטיסטיקות המחזור ואומדני תאוצת הכובד —<br />
כדי לוודא שהחישובים הצליחו ושערכי <span class="math notranslate nohighlight">\(g\)</span> מתקבלים בטווח מציאותי.</p>
<section id="id30">
<h3>חלק א’ — סטטיסטיקות זמן המחזור<a class="headerlink" href="#id30" title="Link to this heading">#</a></h3>
<p>הטבלה <code class="docutils literal notranslate"><span class="pre">period_stats</span></code> מציגה לכל ניסוי:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(T_{\text{mean}}\)</span> — זמן המחזור הממוצע (בשניות)</p></li>
<li><p><span class="math notranslate nohighlight">\(T_{\text{std}}\)</span> — סטיית התקן של זמני המחזור</p></li>
<li><p><span class="math notranslate nohighlight">\(T_{\text{count}}\)</span> — מספר המחזורים שנמצאו</p></li>
<li><p><span class="math notranslate nohighlight">\(f_s\)</span> — קצב הדגימה המשוער (Hz)</p></li>
</ul>
<p>הנתונים הללו מאפשרים להעריך את יציבות המדידה והאיכות של האות בכל ניסוי.</p>
</section>
<section id="id31">
<h3>חלק ב’ — אומדן תאוצת הכובד ורווחי אמון<a class="headerlink" href="#id31" title="Link to this heading">#</a></h3>
<p>הטבלה <code class="docutils literal notranslate"><span class="pre">g_stats</span></code> מציגה את ערכי תאוצת הכובד שחושבו לכל ניסוי, יחד עם אי־הוודאות:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>סימון</p></th>
<th class="head text-left"><p>משמעות</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(L_m\)</span></p></td>
<td class="text-left"><p>אורך המטוטלת במטרים</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(T_{\text{mean}}\)</span></p></td>
<td class="text-left"><p>זמן המחזור הממוצע</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(g_{\text{est}}\)</span></p></td>
<td class="text-left"><p>אומדן תאוצת הכובד לפי נוסחת המטוטלת</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(\sigma_g\)</span></p></td>
<td class="text-left"><p>אי־ודאות באומדן <span class="math notranslate nohighlight">\(g\)</span> (שגיאת התקן המשוקללת)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(g_{\text{CI\_low}}, g_{\text{CI\_high}}\)</span></p></td>
<td class="text-left"><p>גבולות רווח סמך של 95% סביב <span class="math notranslate nohighlight">\(g_{\text{est}}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(\sigma_L, \sigma_T\)</span></p></td>
<td class="text-left"><p>אי־ודאות במדידת האורך והזמן, בהתאמה</p></td>
</tr>
</tbody>
</table>
</div>
<p>בבדיקה סופית, הערכים של <span class="math notranslate nohighlight">\(g_{\text{est}}\)</span> אמורים להיות קרובים ל־<span class="math notranslate nohighlight">\(9.8 \, \text{m/s}^2\)</span><br />
ובעלי רווחי אמון צרים יחסית, מה שמעיד על ניסוי יציב ומדויק.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- 6) Done: show concise tables ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Period statistics per trial ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">period_stats</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Gravity estimates per trial (with 95% CIs) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g_stats</span><span class="p">[[</span>
    <span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="s2">&quot;L_m&quot;</span><span class="p">,</span> <span class="s2">&quot;T_mean&quot;</span><span class="p">,</span> <span class="s2">&quot;T_std&quot;</span><span class="p">,</span> <span class="s2">&quot;T_count&quot;</span><span class="p">,</span> <span class="s2">&quot;fs_est&quot;</span><span class="p">,</span>
    <span class="s2">&quot;g_est&quot;</span><span class="p">,</span> <span class="s2">&quot;sigma_g&quot;</span><span class="p">,</span> <span class="s2">&quot;g_CI_low&quot;</span><span class="p">,</span> <span class="s2">&quot;g_CI_high&quot;</span><span class="p">,</span> <span class="s2">&quot;sigma_L&quot;</span><span class="p">,</span> <span class="s2">&quot;sigma_T&quot;</span>
<span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Period statistics per trial ===
  trial_id    T_mean     T_std  T_count      fs_est
0      T01  1.342682  0.014546        5  100.000000
1      T02  1.746500  0.118054        6   80.000000
2      T03  2.198418  0.021155        7   60.000111

=== Gravity estimates per trial (with 95% CIs) ===
  trial_id   L_m    T_mean     T_std  T_count      fs_est      g_est  \
0      T01  0.45  1.342682  0.014546        5  100.000000   9.854297   
1      T02  0.80  1.746500  0.118054        6   80.000000  10.354102   
2      T03  1.20  2.198418  0.021155        7   60.000111   9.802128   

    sigma_g  g_CI_low  g_CI_high  sigma_L   sigma_T  
0  0.145279  9.569549  10.139044    0.005  0.006505  
1  0.575101  9.226903  11.481301    0.005  0.048195  
2  0.082171  9.641073   9.963183    0.005  0.007996  
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="analysis-g">
<h1>חלק 3: ניתוח (Analysis) – השוואת <span class="math notranslate nohighlight">\(g\)</span>, שינוי צורה, ובדיקת תוקף ההנחות<a class="headerlink" href="#analysis-g" title="Link to this heading">#</a></h1>
<p>בשלב זה ננתח את התוצאות שחישבנו: נשווה את אומדני תאוצת הכובד <span class="math notranslate nohighlight">\(g\)</span> בין אשכולות של אורך המטוטלת <span class="math notranslate nohighlight">\(L_m\)</span> וזוויות שחרור, נעצב את הנתונים מחדש כדי לראות את <span class="math notranslate nohighlight">\(\bar{T}\)</span> על פני ניסויים ואורכים, ונאמת את הנחת הזוויות הקטנות באמצעות מתאם בין זמן המחזור לאמפליטודה ההתחלתית.</p>
<section id="id32">
<h2>השלבים העיקריים<a class="headerlink" href="#id32" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>השוואת <span class="math notranslate nohighlight">\(g\)</span> לפי אשכולות <span class="math notranslate nohighlight">\(L_m\)</span> וזוויות שחרור (Groupby &amp; Binning)</strong><br />
נגדיר מחיצות לאורך <span class="math notranslate nohighlight">\(L_m\)</span> ולזווית השחרור <span class="math notranslate nohighlight">\(\theta_0\)</span> (במעלות), ונחשב לכל דלי את סטטיסטיקות <span class="math notranslate nohighlight">\(g\)</span> (מספר דגימות, ממוצע, סטיית תקן).<br />
המטרה: לזהות תלות שיטתית של <span class="math notranslate nohighlight">\(g\)</span> ב-<span class="math notranslate nohighlight">\(L_m\)</span> או ב-<span class="math notranslate nohighlight">\(\theta_0\)</span> שעשויה להעיד על הטיה ניסויית או חריגה מהנחת הזוויות הקטנות.</p></li>
<li><p><strong>שינוי צורה (Reshape): טבלת ציר של <span class="math notranslate nohighlight">\(\bar{T}\)</span> לפי מזהה ניסוי ואורך</strong><br />
נייצר Pivot שבו השורות הן <code class="docutils literal notranslate"><span class="pre">trial_id</span></code>, העמודות הן <span class="math notranslate nohighlight">\(L_m\)</span>, והערכים הם <span class="math notranslate nohighlight">\(\bar{T}\)</span>.<br />
המטרה: סקירה מהירה של זמני המחזור הממוצעים על פני ניסויים שונים ואורכים שונים, ולאיתור דפוסים או חריגים.</p></li>
<li><p><strong>וולידציה: מתאם בין תקופה לאמפליטודה</strong><br />
נחשב את מתאם פיארסון בין <span class="math notranslate nohighlight">\(\bar{T}\)</span> לבין <span class="math notranslate nohighlight">\(\theta_0\)</span> (זווית השחרור). בצ regime של זוויות קטנות מצפים לתלות חלשה מאוד, כלומר <span class="math notranslate nohighlight">\(|\rho|\ll 1\)</span>.<br />
מתאם גדול עשוי להעיד על זוויות גדולות מדי, זיהוי מחזורים לא יציב, או רעש/הטיה בנתונים.</p></li>
</ol>
</section>
<section id="id33">
<h2>תוצרים מרכזיים<a class="headerlink" href="#id33" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">g_by_L</span></code>, <code class="docutils literal notranslate"><span class="pre">g_by_angle</span></code> — טבלאות סיכום של <span class="math notranslate nohighlight">\(g\)</span> לפי דליי <span class="math notranslate nohighlight">\(L_m\)</span> ולפי דליי <span class="math notranslate nohighlight">\(\theta_0\)</span> (עמודות: <code class="docutils literal notranslate"><span class="pre">count</span></code>, <code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">std</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">T_pivot</span></code> — טבלת ציר של <span class="math notranslate nohighlight">\(\bar{T}\)</span> לפי <code class="docutils literal notranslate"><span class="pre">trial_id</span> <span class="pre">×</span> <span class="pre">L_m</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">corr_T_angle</span></code> — ערך מתאם פיארסון בין <span class="math notranslate nohighlight">\(\bar{T}\)</span> ל-<span class="math notranslate nohighlight">\(\theta_0\)</span> (או מטריצת מתאמים מלאה).</p></li>
</ul>
<p>לאחר הניתוח נוכל לאשש שהאומדנים של <span class="math notranslate nohighlight">\(g\)</span> עקביים על פני אורכים וזוויות שונות, ושבמשטר זוויות קטנות הקשר בין התקופה לאמפליטודה אכן חלש.</p>
</section>
<section id="pandas">
<h2>שלב 1: ניתוח והשוואה באמצעות Pandas<a class="headerlink" href="#pandas" title="Link to this heading">#</a></h2>
<p>לאחר שחישבנו את ערכי תאוצת הכובד <span class="math notranslate nohighlight">\(g\)</span> עבור כל ניסוי, נבצע כעת ניתוח השוואתי כדי לבדוק את עקביות התוצאות ואת תוקף ההנחות הפיזיקליות.<br />
המטרה היא לזהות האם קיימת תלות שיטתית בין <span class="math notranslate nohighlight">\(g\)</span> לבין <strong>אורך המטוטלת</strong> (<span class="math notranslate nohighlight">\(L_m\)</span>) או <strong>זווית השחרור</strong> (<span class="math notranslate nohighlight">\(\theta_0\)</span>), וכן לבחון את פיזור הערכים בין ניסויים.</p>
<p>בשלב זה נשתמש בכלים של ספריית <strong>Pandas</strong> לעיבוד וניתוח נתונים טבלאיים.</p>
<section id="id34">
<h3>שלבי הניתוח:<a class="headerlink" href="#id34" title="Link to this heading">#</a></h3>
<ol class="arabic">
<li><p><strong>השוואת <span class="math notranslate nohighlight">\(g\)</span> לפי אורכי המטוטלת וזוויות השחרור</strong><br />
נבצע חלוקה (binning) של הנתונים לפי טווחי אורך <span class="math notranslate nohighlight">\(L_m\)</span> ולפי טווחי זווית שחרור (במעלות).<br />
עבור כל טווח נחשב את:</p>
<ul class="simple">
<li><p>מספר הניסויים (<code class="docutils literal notranslate"><span class="pre">count</span></code>)</p></li>
<li><p>ממוצע ערכי <span class="math notranslate nohighlight">\(g\)</span> (<code class="docutils literal notranslate"><span class="pre">mean</span></code>)</p></li>
<li><p>סטיית התקן (<code class="docutils literal notranslate"><span class="pre">std</span></code>)</p></li>
</ul>
<p>כך נוכל לבדוק האם יש שינוי מובהק בערכי <span class="math notranslate nohighlight">\(g\)</span> עם שינוי באורך או בזווית — דבר שאינו צפוי בתיאוריה, אלא אם יש שגיאות מדידה או חריגה מהנחת הזוויות הקטנות.</p>
</li>
<li><p><strong>הצגת תוצאות קבוצתיות</strong><br />
נדפיס את טבלאות הסיכום:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">$g_{by\_L}$</span></code> — לפי קבוצות אורכים</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$g_{by\_angle}$</span></code> — לפי קבוצות זוויות</p></li>
</ul>
<p>טבלאות אלו מספקות מבט כולל על איכות הניסוי ועל עקביות החישובים בין סדרות ניסוי שונות.</p>
</li>
</ol>
<p>השלב הבא יעסוק בשינוי צורת הנתונים (Pivot) ובבדיקת מתאם בין זמן המחזור לזווית השחרור, כדי לאשש את ההנחה שהתלות בין השניים חלשה עבור זוויות קטנות.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g_stats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>trial_id</th>
      <th>T_mean</th>
      <th>T_std</th>
      <th>T_count</th>
      <th>fs_est</th>
      <th>L_m</th>
      <th>release_angle_deg</th>
      <th>sigma_L</th>
      <th>sigma_T</th>
      <th>g_est</th>
      <th>sigma_g</th>
      <th>g_CI_low</th>
      <th>g_CI_high</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>T01</td>
      <td>1.342682</td>
      <td>0.014546</td>
      <td>5</td>
      <td>100.000000</td>
      <td>0.45</td>
      <td>10</td>
      <td>0.005</td>
      <td>0.006505</td>
      <td>9.854297</td>
      <td>0.145279</td>
      <td>9.569549</td>
      <td>10.139044</td>
    </tr>
    <tr>
      <th>1</th>
      <td>T02</td>
      <td>1.746500</td>
      <td>0.118054</td>
      <td>6</td>
      <td>80.000000</td>
      <td>0.80</td>
      <td>20</td>
      <td>0.005</td>
      <td>0.048195</td>
      <td>10.354102</td>
      <td>0.575101</td>
      <td>9.226903</td>
      <td>11.481301</td>
    </tr>
    <tr>
      <th>2</th>
      <td>T03</td>
      <td>2.198418</td>
      <td>0.021155</td>
      <td>7</td>
      <td>60.000111</td>
      <td>1.20</td>
      <td>15</td>
      <td>0.005</td>
      <td>0.007996</td>
      <td>9.802128</td>
      <td>0.082171</td>
      <td>9.641073</td>
      <td>9.963183</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- Analysis with pandas: grouping, reshaping, and validation ---</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Assumptions:</span>
<span class="c1"># - `g_stats` has one row per trial_id with columns: [&#39;trial_id&#39;,&#39;L_m&#39;,&#39;g_est&#39;,&#39;release_angle_deg&#39;, ...]</span>
<span class="c1"># - `period_stats` has per-trial period statistics with columns: [&#39;trial_id&#39;,&#39;T_mean&#39;, ...]</span>
<span class="c1"># If your column names differ, adjust below accordingly.</span>

<span class="c1"># ---------------------------</span>
<span class="c1"># 1) Groupby: compare g by L_m bins and by release_angle_deg buckets</span>
<span class="c1"># ---------------------------</span>

<span class="c1"># Define length bins (meters). Adjust edges as needed for your dataset.</span>
<span class="n">length_bins</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">,</span> <span class="mf">1.50</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>
<span class="n">length_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;[0.00–0.25)&quot;</span><span class="p">,</span> <span class="s2">&quot;[0.25–0.50)&quot;</span><span class="p">,</span> <span class="s2">&quot;[0.50–0.75)&quot;</span><span class="p">,</span> <span class="s2">&quot;[0.75–1.00)&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;[1.00–1.50)&quot;</span><span class="p">,</span> <span class="s2">&quot;[1.50–2.00)&quot;</span><span class="p">,</span> <span class="s2">&quot;≥2.00&quot;</span><span class="p">]</span>

<span class="n">g_by_L</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">g_stats</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">L_bin</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;L_m&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">length_bins</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">length_labels</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;L_bin&quot;</span><span class="p">,</span> <span class="s2">&quot;g_est&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;L_bin&quot;</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s2">&quot;g_est&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="s2">&quot;std&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;L_bin&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Define angle buckets (degrees). Small-angle regime typically ≤ ~15°; include wider buckets for diagnostics.</span>
<span class="n">angle_bins</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">45.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>
<span class="n">angle_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0–5°&quot;</span><span class="p">,</span> <span class="s2">&quot;5–10°&quot;</span><span class="p">,</span> <span class="s2">&quot;10–15°&quot;</span><span class="p">,</span> <span class="s2">&quot;15–20°&quot;</span><span class="p">,</span> <span class="s2">&quot;20–30°&quot;</span><span class="p">,</span> <span class="s2">&quot;30–45°&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;45°&quot;</span><span class="p">]</span>

<span class="n">g_by_angle</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">g_stats</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">angle_bucket</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">g_stats</span><span class="p">[</span><span class="s2">&quot;release_angle_deg&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">angle_bins</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">angle_labels</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;angle_bucket&quot;</span><span class="p">,</span> <span class="s2">&quot;g_est&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;angle_bucket&quot;</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s2">&quot;g_est&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="s2">&quot;std&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;angle_bucket&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== g by L_m bins ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g_by_L</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== g by release_angle_deg buckets ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g_by_angle</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== g by L_m bins ===
      L_bin  count      mean  std
[0.25–0.50)      1  9.854297  NaN
[0.75–1.00)      1 10.354102  NaN
[1.00–1.50)      1  9.802128  NaN

=== g by release_angle_deg buckets ===
angle_bucket  count      mean  std
      10–15°      1  9.854297  NaN
      15–20°      1  9.802128  NaN
      20–30°      1 10.354102  NaN
</pre></div>
</div>
</div>
</div>
</section>
<section id="bar-t">
<h3>שלב 2: שינוי צורה – טבלת ציר של <span class="math notranslate nohighlight">\(\bar{T}\)</span> לפי ניסוי ואורך המטוטלת<a class="headerlink" href="#bar-t" title="Link to this heading">#</a></h3>
<p>בשלב זה נרצה להציג את זמני המחזור הממוצעים (<span class="math notranslate nohighlight">\(\bar{T}\)</span>) של כל ניסוי בצורה נוחה להשוואה חזותית.</p>
<p>נשלב תחילה את טבלת הסטטיסטיקות <code class="docutils literal notranslate"><span class="pre">period_stats</span></code> עם עמודת אורכי המטוטלת <code class="docutils literal notranslate"><span class="pre">L_m</span></code> מתוך <code class="docutils literal notranslate"><span class="pre">g_stats</span></code>, כדי להבטיח שלכל מזהה ניסוי (<code class="docutils literal notranslate"><span class="pre">trial_id</span></code>) קיים גם ערך אורך מתאים.<br />
לאחר מכן ניצור <strong>טבלת ציר (Pivot Table)</strong> שבה:</p>
<ul class="simple">
<li><p><strong>השורות</strong> מייצגות את מזהי הניסויים (<code class="docutils literal notranslate"><span class="pre">trial_id</span></code>),</p></li>
<li><p><strong>העמודות</strong> מייצגות את אורכי המטוטלת (<span class="math notranslate nohighlight">\(L_m\)</span>),</p></li>
<li><p><strong>התאים</strong> מכילים את הערכים של זמן המחזור הממוצע (<span class="math notranslate nohighlight">\(\bar{T}\)</span>).</p></li>
</ul>
<p>אם לכל ניסוי יש רק אורך אחד, רוב הערכים בטבלה יהיו ריקים, אך עדיין מתקבלת תצוגה נוחה שמאפשרת:</p>
<ul class="simple">
<li><p>לזהות במהירות את הקשר בין זמן המחזור לאורך,</p></li>
<li><p>לאתר ניסויים חריגים או מדידות חסרות,</p></li>
<li><p>להבחין בדפוסים כלליים בין קבוצות ניסויים.</p></li>
</ul>
<p>טבלה זו (<code class="docutils literal notranslate"><span class="pre">T_pivot</span></code>) מהווה שלב ביניים שימושי לפני ביצוע ניתוחים מתקדמים יותר — כגון מציאת מתאם בין תקופה לאמפליטודה או בדיקת עקביות בין סדרות ניסוי שונות.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ---------------------------</span>
<span class="c1"># 2) Reshape: pivot table of T_mean by trial_id × L_m</span>
<span class="c1"># ---------------------------</span>
<span class="c1"># Join L_m onto period_stats to ensure each trial&#39;s length is available.</span>
<span class="n">trial_lengths</span> <span class="o">=</span> <span class="n">g_stats</span><span class="p">[[</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="s2">&quot;L_m&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="n">period_with_L</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">period_stats</span><span class="p">[[</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="s2">&quot;T_mean&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">trial_lengths</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Create a pivot: rows = trial_id, columns = L_m, values = T_mean.</span>
<span class="c1"># If each trial has a single L_m, this will be a mostly diagonal-like layout;</span>
<span class="c1"># still useful to quickly scan T_mean aligned by length values.</span>
<span class="n">T_pivot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">period_with_L</span><span class="p">,</span>
    <span class="n">index</span><span class="o">=</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;L_m&quot;</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="s2">&quot;T_mean&quot;</span><span class="p">,</span>
    <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;first&quot;</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Pivot table: T_mean by trial_id × L_m ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">T_pivot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Pivot table: T_mean by trial_id × L_m ===
L_m           0.45    0.80      1.20
trial_id                            
T01       1.342682     NaN       NaN
T02            NaN  1.7465       NaN
T03            NaN     NaN  2.198418
</pre></div>
</div>
</div>
</div>
</section>
<section id="id35">
<h3>שלב 3: ולידציה – בדיקת הקשר בין זמן המחזור לזווית השחרור<a class="headerlink" href="#id35" title="Link to this heading">#</a></h3>
<p>לפי התיאוריה של המטוטלת הקלאסית, כאשר זווית התנודה ההתחלתית קטנה (בדרך כלל עד כ־<span class="math notranslate nohighlight">\(15^\circ\)</span>),<br />
זמן המחזור <span class="math notranslate nohighlight">\(T\)</span> כמעט <strong>שאינו תלוי באמפליטודה</strong>.<br />
לכן נצפה לראות מתאם חלש מאוד בין זמן המחזור הממוצע <span class="math notranslate nohighlight">\(\bar{T}\)</span> לבין זווית השחרור <span class="math notranslate nohighlight">\(\theta_0\)</span>.</p>
<p>בשלב זה נחשב את <strong>מתאם פיארסון</strong> בין שני המשתנים:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\bar{T}\)</span> — זמן המחזור הממוצע מכל ניסוי</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta_0\)</span> — זווית השחרור (במעלות)</p></li>
</ul>
<p>נשתמש ב־<code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.corr(method='pearson')</span></code> כדי למדוד את עוצמת הקשר הליניארי ביניהם.</p>
<p>תוצאות אפשריות:</p>
<ul class="simple">
<li><p>אם <span class="math notranslate nohighlight">\(|r| \ll 1\)</span> (למשל <span class="math notranslate nohighlight">\(r \approx 0.0\)</span>–<span class="math notranslate nohighlight">\(0.2\)</span>) → הקשר חלש מאוד, בהתאם להנחת הזוויות הקטנות.</p></li>
<li><p>אם <span class="math notranslate nohighlight">\(r\)</span> גבוה יותר (למשל <span class="math notranslate nohighlight">\(r &gt; 0.4\)</span>) → ייתכן שהניסויים כללו זוויות גדולות מדי,<br />
או שהמדידה של זמני המחזור אינה מדויקת מספיק.</p></li>
</ul>
<p>בדיקה זו מהווה מבחן עקביות חשוב לתוקף הפיזיקלי של הנתונים ולנכונות ההנחות על שיטת המדידה.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ---------------------------</span>
<span class="c1"># 3) Validation: correlation between period and amplitude</span>
<span class="c1"># ---------------------------</span>
<span class="c1"># Expectation: at small angles, the period should be (nearly) independent of amplitude (weak correlation).</span>
<span class="c1"># We&#39;ll compute Pearson correlation between per-trial T_mean and release_angle_deg.</span>

<span class="n">period_angle</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">period_stats</span><span class="p">[[</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="s2">&quot;T_mean&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">g_stats</span><span class="p">[[</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="s2">&quot;release_angle_deg&quot;</span><span class="p">]],</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;trial_id&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;T_mean&quot;</span><span class="p">,</span> <span class="s2">&quot;release_angle_deg&quot;</span><span class="p">])</span>
<span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">period_angle</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">period_angle</span><span class="p">[[</span><span class="s2">&quot;T_mean&quot;</span><span class="p">,</span> <span class="s2">&quot;release_angle_deg&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;pearson&quot;</span><span class="p">)</span>
    <span class="n">corr_T_angle</span> <span class="o">=</span> <span class="n">corr_matrix</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;T_mean&quot;</span><span class="p">,</span> <span class="s2">&quot;release_angle_deg&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Validation: Pearson correlation (T_mean vs. release_angle_deg) ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;r = </span><span class="si">{</span><span class="n">corr_T_angle</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">  (|r| &lt;&lt; 1 suggests weak dependence at small angles)&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Validation: Not enough data to compute correlation (missing T_mean or release_angle_deg). ===&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Validation: Pearson correlation (T_mean vs. release_angle_deg) ===
r = 0.472  (|r| &lt;&lt; 1 suggests weak dependence at small angles)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "TauInnov/CFS",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./course/weeks/week_11"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">מדידת תאוצת הכובד בעזרת מטוטלת חכמה</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">רקע ומוטיבציה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">המודל הפיזיקלי</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">תנודות קטנות של מטוטלת פשוטה</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">תיקון לזוויות שאינן קטנות</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">דעיכה (חיכוך ואיבודי אנרגיה)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">מטרה ניסויית</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">קבצי הנתונים</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">שאלת המחקר</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">📊 חלק 1 — הכנת הנתונים וצעדים ראשוניים בניתוח</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">מבנה הנתונים</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pendulum-timeseries-csv">1. <strong>pendulum_timeseries.csv</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trials-csv">2. <strong>trials.csv</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sensors-csv">3. <strong>sensors.csv</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">שלבים 1–2: טעינת הנתונים ובדיקות תקינות בסיסיות</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-cleaning">שלב 3: ניקוי נתוני הסדרה הזמנית (Time-Series Cleaning)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">שלב 4: מיזוג נתוני המדידה עם נתוני המטא־דאטה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">שלב 5: תיקון כיול והכנת שדות פיזיקליים לחישוב</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sanity-checks">שלב 6: בדיקות תקינות מבניות מהירות (Sanity Checks)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">שלב 7: סיכום טווח הזמן לכל ניסוי ובדיקת קצב הדגימה</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">מבנה הנתונים:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-engineering">חלק 2: הנדסת מאפיינים (Feature Engineering) – חישוב זמן מחזור והערכת תאוצת הכובד</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">השלבים העיקריים:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">שלב 1: המרת יחידות זווית למידות רדיאנים</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#period-detection">שלב 2: חישוב זמני מחזור לניסוי בודד (Period Detection)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">מה עושה הפונקציה בפועל:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">תוצאת הפונקציה:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">שלב 3: חישוב זמני מחזור לכל הניסויים</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">מה מתבצע כאן:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">התוצאה:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">שלב 4: חישוב סטטיסטיקות זמן מחזור לכל ניסוי</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">חלק א’ – חישוב מדדים סטטיסטיים</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-rate">חלק ב’ – חישוב קצב הדגימה המשוער (Sampling Rate)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">תוצאה:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#g">שלב 5: אומדן <span class="math notranslate nohighlight">\(g\)</span> לכל ניסוי עם אי־ודאות (הפצת שגיאה)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">אי־ודאות במדידות</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#first-order">הפצת שגיאה (First-order)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">רווח סמך 95%</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">שלב 6: הצגת התוצאות הסופיות</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">חלק א’ — סטטיסטיקות זמן המחזור</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">חלק ב’ — אומדן תאוצת הכובד ורווחי אמון</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-g">חלק 3: ניתוח (Analysis) – השוואת <span class="math notranslate nohighlight">\(g\)</span>, שינוי צורה, ובדיקת תוקף ההנחות</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">השלבים העיקריים</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">תוצרים מרכזיים</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas">שלב 1: ניתוח והשוואה באמצעות Pandas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id34">שלבי הניתוח:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bar-t">שלב 2: שינוי צורה – טבלת ציר של <span class="math notranslate nohighlight">\(\bar{T}\)</span> לפי ניסוי ואורך המטוטלת</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id35">שלב 3: ולידציה – בדיקת הקשר בין זמן המחזור לזווית השחרור</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>